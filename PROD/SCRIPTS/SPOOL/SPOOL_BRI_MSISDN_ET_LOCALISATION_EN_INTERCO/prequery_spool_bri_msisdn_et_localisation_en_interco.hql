SELECT IF(
    T_1.SPOOL_BRI_MSISDN_ET_LOCALISATION_EN_INTERCO = 0
    AND T_2.FT_OTHER_PARTY_SITE_TRAFFIC > DATEDIFF(LAST_DAY('###SLICE_VALUE###'||'-01') , '###SLICE_VALUE###'||'-01')
    , "OK"
    , "NOK"
) FT_EXIST
FROM
(SELECT COUNT(*) SPOOL_BRI_MSISDN_ET_LOCALISATION_EN_INTERCO FROM SPOOL.SPOOL_BRI_MSISDN_ET_LOCALISATION_EN_INTERCO WHERE EVENT_MONTH = '###SLICE_VALUE###') T_1,
(SELECT COUNT(DISTINCT EVENT_DATE) FT_OTHER_PARTY_SITE_TRAFFIC FROM MON.SPARK_FT_OTHER_PARTY_SITE_TRAFFIC WHERE EVENT_DATE BETWEEN TO_DATE(CONCAT('###SLICE_VALUE###','-01')) AND  LAST_DAY(TO_DATE(CONCAT('###SLICE_VALUE###','-01')))) T_2
