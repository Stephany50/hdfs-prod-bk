-- Création TT
CREATE EXTERNAL TABLE CDR.TT_ORANGEPRO_PORTAIL_UNIFIE ( 
    ORIGINAL_FILE_NAME VARCHAR(50), 
    ORIGINAL_FILE_SIZE INT, 
    ORIGINAL_FILE_LINE_COUNT INT, 
    id bigint, 
    user_id bigint, 
    action VARCHAR(200), 
    details VARCHAR(450), 
    archived int, 
    created_at TIMESTAMP
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ';' 
LOCATION '/PROD/TT/ORANGEPRO_PU' 
TBLPROPERTIES ('serialization.null.format'='');

--Création IT
CREATE TABLE CDR.SPARK_IT_ORANGEPRO_PORTAIL_UNIFIE (
    id bigint, 
    user_id bigint, 
    action VARCHAR(200), 
    details VARCHAR(450), 
    archived int, 
    created_at TIMESTAMP, 
    ORIGINAL_FILE_NAME VARCHAR(50), 
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    INSERT_DATE TIMESTAMP) 
PARTITIONED BY (ORIGINAL_FILE_DATE DATE) 
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY');