CREATE TABLE CDR.SPARK_IT_VAS_RETAILLER_IRIS (
START_TIME VARCHAR(100),
JOUR INT,
HOUR INT,
REFERENCE_TRANSACTION_ID VARCHAR(100),
TRANSACTION_ID VARCHAR(100),
RET_MSISDN VARCHAR(100),
SUB_MSISDN VARCHAR(100),
OPTION_NUMBER INT,
OFFER_ID VARCHAR(50),
OFFER_NAME VARCHAR(100),
OFFER_TYPE VARCHAR(75),
SUBSCRIBER_BONUS VARCHAR(100),
RECHARGE_AMOUNT INT,
RETAILER_COMMISSION INT,
CAMPAIGN_NAME VARCHAR(100),
CHANNEL VARCHAR(10),
PRETUPS_TRANSACTION_ID_IN VARCHAR(100),
PRETUPS_TRANSACTION_ID_OUT VARCHAR(100),
PRETUPS_STATUSCODE VARCHAR(100),
PRETUPS_MESSAGE VARCHAR(200),
PRETUPS_TIMETAKEN VARCHAR(100),
VAS_NODE VARCHAR(25),
VAS_TRANSACTION_ID_IN VARCHAR(100),
VAS_TRANSACTION_ID_OUT VARCHAR(100),
VAS_STATUS_CODE VARCHAR(100),
VAS_MESSAGE VARCHAR(200),
VAS_TIMETAKEN VARCHAR(100),
PRETUPS_REVERSAL_FLAG VARCHAR(100),
PRETUPS_REVERSAL_STATUS_CODE VARCHAR(100),
PRETUPS_REVERSAL_STATUS_MSG VARCHAR(400),
PRETUPS_REVERSAL_ID_OUT VARCHAR(200),
PRETUPS_REVERSAL_TIMETAKEN VARCHAR(100),
SMS_STATUS_CODE VARCHAR(100),
SMS_TIMETAKEN VARCHAR(100),
SMS_STATUS_CODE_RETAILER VARCHAR(100),
SMS_TIMETAKEN_RETAILER VARCHAR(100),
TRANSACTION_STATUS_OVERALL VARCHAR(50),
TRANSACTION_TIMETAKEN VARCHAR(100),
E2E_TIMETAKEN VARCHAR(100),
END_TIME VARCHAR(100),
ORIGINAL_FILE_NAME VARCHAR(50),
ORIGINAL_FILE_SIZE VARCHAR(50),
ORIGINAL_FILE_LINE_COUNT VARCHAR(255),
ORIGINAL_FILE_DATE DATE,
INSERT_DATE TIMESTAMP
)
PARTITIONED BY (SDATE DATE)
CLUSTERED BY(TRANSACTION_ID) INTO 64 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')