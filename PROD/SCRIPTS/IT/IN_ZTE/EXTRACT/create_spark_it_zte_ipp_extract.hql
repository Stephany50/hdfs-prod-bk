CREATE TABLE IF NOT EXISTS CDR.SPARK_IT_ZTE_IPP_EXTRACT (
    IPP_NAME            VARCHAR(500),
    IPP_CODE            INT,
    IPP_AMOUNT          DOUBLE,
    CREATED_DATE        DATE,
    ORIGINAL_FILE_NAME VARCHAR(60),
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    INSERT_DATE TIMESTAMP
)
PARTITIONED BY (ORIGINAL_FILE_DATE DATE)
CLUSTERED BY(ORIGINAL_FILE_NAME) INTO 4 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')