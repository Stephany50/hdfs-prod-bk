-- Cette table contient l'ensemble des lignes identifi√©es : personnes physiques (majeurs, mineurs, PP) 
-- et personnes morales utilisateur de flotte et M2M.
CREATE TABLE CDR.SPARK_IT_BDI_FULL(          
   msisdn string,                                 
   type_personne string,                          
   nom_prenom string,                             
   id_type_piece string,                          
   type_piece string,                             
   numero_piece string,                           
   date_expiration string,                        
   date_naissance string,                         
   date_activation string,                        
   adresse string,                                
   quartier string,                               
   ville string,                                  
   statut string,                                 
   statut_validation_bo string,                   
   motif_rejet_bo string,                         
   date_validation_bo string,                     
   login_validateur_bo string,                    
   canal_validateur_bo string,                    
   type_abonnement string,                        
   csmoddate string,                              
   ccmoddate string,                              
   compte_client_structure string,                
   nom_structure string,                          
   numero_registre_commerce string,               
   numero_piece_representant_lega string,         
   imei string,                                   
   statut_derogation string,                      
   region_administrative string,                  
   region_commerciale string,                     
   site_name string,                              
   ville_site string,                             
   offre_commerciale string,                      
   type_contrat string,                           
   segmentation string,                           
   date_souscription string,                      
   date_changement_statut string,                 
   ville_structure string,                        
   quartier_structure string,                     
   raison_statut string,                          
   prenom string,                                 
   nom string,                                    
   customer_id string,                            
   contract_id string,                            
   compte_client string,                          
   plan_localisation string,                      
   contrat_soucription string,                    
   acceptation_cgv string,                        
   disponibilite_scan string,                     
   nom_tuteur string,                             
   prenom_tuteur string,                          
   date_naissance_tuteur string,                  
   numero_piece_tuteur string,                    
   date_expiration_tuteur string,                 
   id_type_piece_tuteur string,                   
   type_piece_tuteur string,                      
   adresse_tuteur string,                         
   identificateur string,                         
   localisation_identificateur string,            
   profession string,                             
   insert_date timestamp)                        
COMMENT 'SPARK_IT_BDI_FULL'                        
PARTITIONED BY (original_file_date date)
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY');