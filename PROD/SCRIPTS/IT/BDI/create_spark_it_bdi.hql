CREATE TABLE CDR.SPARK_IT_BDI (
  MSISDN                    VARCHAR(400),
  NUMERO_PIECE              VARCHAR(400),
  TYPE_PIECE                VARCHAR(400),
  NOM                       VARCHAR(400),
  DATE_NAISSANCE            DATE,
  DATE_EXPIRATION           DATE,
  ADDRESSE                  VARCHAR(400),
  NUMERO_PIECE_TUTEUR       VARCHAR(400),
  NOM_PARENT                VARCHAR(400),
  DATE_NAISSANCE_TUTEUR     VARCHAR(400),
  NOM_STRUCTURE             VARCHAR(400),
  NUMERO_REGISTRE_COMMERCE  VARCHAR(400),
  NUMERO_PIECE_REP_LEGAL    VARCHAR(400),
  TYPE_PERSONNE             VARCHAR(400),
  DATE_ACTIVATION           TIMESTAMP,
  DATE_CHANGEMENT_STATUT    TIMESTAMP,
  STATUT_BSCS               VARCHAR(400),
  ODBINCOMINGCALLS          VARCHAR(400),
  ODBOUTGOINGCALLS          VARCHAR(400),
  IMEI                      VARCHAR(400),
  ADRESSE_TUTEUR            VARCHAR(400),
  ACCEPTATION_CGV           VARCHAR(400),
  CONTRAT_SOUCRIPTION       VARCHAR(400),
  DISPONIBILITE_SCAN        VARCHAR(400),
  PLAN_LOCALISATION         VARCHAR(400),
  TYPE_PIECE_TUTEUR         VARCHAR(400),
  DATE_VALIDATION_BO        TIMESTAMP,
  STATUT_VALIDATION_BO      VARCHAR(100),
  MOTIF_REJET_BO            VARCHAR(400),
  ORIGINAL_FILE_NAME VARCHAR(200),
  ORIGINAL_FILE_SIZE INT,
  ORIGINAL_FILE_LINE_COUNT INT,
  INSERT_DATE TIMESTAMP
 )
PARTITIONED BY (ORIGINAL_FILE_DATE DATE)
CLUSTERED BY(MSISDN) INTO 8 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')
