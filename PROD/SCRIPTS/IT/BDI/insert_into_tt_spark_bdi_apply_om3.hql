INSERT INTO TABLE TMP.TT_SPARK_BDI2
SELECT
 MSISDN,
 CUSTOMER_ID,
 CONTRACT_ID,
 COMPTE_CLIENT,
 TYPE_PERSONNE,
 TYPE_PIECE,
  NUMERO_PIECE,
  ID_TYPE_PIECE,
 NOM_PRENOM,
 NOM,
 PRENOM,
 DATE_NAISSANCE,
 DATE_EXPIRATION,
 if((ADRESSE = "" OR ADRESSE IS NULL) AND NOT(odbIncomingCalls = '1' AND odbOutgoingCalls = '1') AND TYPE_PERSONNE = 'PP',ADRESSE = "DOUALA", ADRESSE)  ADRESSE,
 VILLE,
 QUARTIER,
 DATE_SOUSCRIPTION,
 DATE_ACTIVATION,
 STATUT,
 RAISON_STATUT,
 DATE_CHANGEMENT_STATUT,
 PLAN_LOCALISATION,
 CONTRAT_SOUCRIPTION,
DISPONIBILITE_SCAN,
 ACCEPTATION_CGV,
 TYPE_PIECE_TUTEUR,
  NUMERO_PIECE_TUTEUR,
 NOM_TUTEUR,
 DATE_NAISSANCE_TUTEUR,
 DATE_EXPIRATION_TUTEUR,
 ADRESSE_TUTEUR,
 NOM_STRUCTURE,
 NUMERO_REGISTRE_COMMERCE,
  NUMERO_PIECE_REPRESENTANT_LEGAL,
 IF((IMEI = "" OR IMEI IS NULL) AND NOT(odbIncomingCalls = '1' AND odbOutgoingCalls = '1') AND TYPE_PERSONNE = 'PP',IMEI = "351000010000100",IMEI) IMEI,
 STATUT_DEROGATION,
 REGION_ADMINISTRATIVE,
 REGION_COMMERCIALE,
 SITE_NAME,
 VILLE_SITE,
 OFFRE_COMMERCIALE,
 TYPE_CONTRAT,
 SEGMENTATION,
 odbIncomingCalls,
 odbOutgoingCalls
 FROM (select
  MSISDN,
 CUSTOMER_ID,
 CONTRACT_ID,
 COMPTE_CLIENT,
 'PP' AS TYPE_PERSONNE,
 TYPE_PIECE,
  NUMERO_PIECE,
  ID_TYPE_PIECE,
 NOM_PRENOM,
 NOM,
 PRENOM,
 DATE_NAISSANCE,
 DATE_EXPIRATION,
 ADRESSE,
 VILLE,
 QUARTIER,
 DATE_SOUSCRIPTION,
 DATE_ACTIVATION,
 STATUT,
 RAISON_STATUT,
 DATE_CHANGEMENT_STATUT,
 PLAN_LOCALISATION,
 CONTRAT_SOUCRIPTION,
DISPONIBILITE_SCAN,
 ACCEPTATION_CGV,
 TYPE_PIECE_TUTEUR,
  NUMERO_PIECE_TUTEUR,
 NOM_TUTEUR,
 DATE_NAISSANCE_TUTEUR,
 DATE_EXPIRATION_TUTEUR,
 ADRESSE_TUTEUR,
 NOM_STRUCTURE,
 NUMERO_REGISTRE_COMMERCE,
  NUMERO_PIECE_REPRESENTANT_LEGAL,
  IMEI,
 STATUT_DEROGATION,
 REGION_ADMINISTRATIVE,
 REGION_COMMERCIALE,
 SITE_NAME,
 VILLE_SITE,
 OFFRE_COMMERCIALE,
 TYPE_CONTRAT,
 SEGMENTATION,
 odbIncomingCalls,
 odbOutgoingCalls
from
 TMP.TT_SPARK_BDI1 A
 left join
(select * from DIM.DT_ANOMALIEADDRESSEACTIFHLR) n ON (A.MSISDN = n.MSISDN)