CREATE TABLE CDR.SPARK_IT_OMNY_COMMISSION (
ORIGINAL_FILE_NAME        VARCHAR(50),
ORIGINAL_FILE_SIZE        INT,
ORIGINAL_FILE_LINE_COUNT  INT,
COMMISSION_ID             VARCHAR(10),
NETWORK_NAME              VARCHAR(2),
PROFILE_NAME              VARCHAR(40),
SHORT_CODE                VARCHAR(20),
SERVICE_TYPE              VARCHAR(10),
PAYER_GRADE_CODE          VARCHAR(10),
PAYEE_GRADE_CODE          VARCHAR(10),
SERVICE_CHARGE_VERSION    INT,
START_DATETIME            TIMESTAMP,
MIN_TRANSFER_VALUE        DECIMAL(17,2),
MAX_TRANSFER_VALUE        DECIMAL(17,2),
MULTIPLE_OF               DECIMAL(17,2),
MIN_FIXED_COMMISSION      DECIMAL(17,2),
MAX_FIXED_COMMISSION      DECIMAL(17,2),
MIN_PCT_COMMISSION        DECIMAL(17,2),
MAX_PCT_COMMISSION        DECIMAL(17,2),
START_RANGE               DECIMAL(17,2),
END_RANGE                 DECIMAL(17,2),
FIXED_COMMISSION          DECIMAL(17,2),
PCT_COMMISSION            DECIMAL(17,2),
PAYER_CATEGORY_CODE       VARCHAR(10),
PAYEE_CATEGORY_CODE       VARCHAR(10),
PAYER_PAYMENT_TYPE_ID     INT,
PAYEE_PAYMENT_TYPE_ID     INT,
PAYER_TYPE                VARCHAR(10),
PAYEE_TYPE                VARCHAR(10),
SLAB_CODE                 INT,
INSERT_DATE               TIMESTAMP
)
PARTITIONED BY (ORIGINAL_FILE_DATE DATE)
CLUSTERED BY(COMMISSION_ID) INTO 8 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')
