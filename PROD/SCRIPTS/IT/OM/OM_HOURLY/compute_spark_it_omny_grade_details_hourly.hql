INSERT INTO CDR.SPARK_IT_OMNY_GRADE_DETAILS_HOURLY
SELECT
    GRADE_CODE,
    GRADE_NAME,
    CATEGORY_CODE,
    STATUS,
    ORIGINAL_FILE_NAME ,
    ORIGINAL_FILE_SIZE,
    ORIGINAL_FILE_LINE_COUNT,
    CURRENT_TIMESTAMP() INSERT_DATE,
    TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(SUBSTRING (original_file_name, 14, 8),'yyyyMMdd'))) original_file_date
FROM CDR.SPARK_TT_OMNY_GRADE_DETAILS_HOURLY C
       LEFT JOIN (SELECT DISTINCT original_file_name FILE_NAME FROM  CDR.SPARK_IT_OMNY_GRADE_DETAILS_HOURLY) T ON T.file_name = C.original_file_name
WHERE  T.file_name IS NULL