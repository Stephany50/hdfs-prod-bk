INSERT INTO CDR.SPARK_IT_COMMISSIONS_DETAILS_HOURLY
SELECT
    TRANSACTION_ID,
    FROM_UNIXTIME(UNIX_TIMESTAMP(TRANSACTION_DATE,'dd/MM/yyyy HH:mm:ss')) NQ_TRANSACTION_DATE,
    COMMISSION_ID,
    TRANSACTION_AMOUNT,
    PAYER_USER_ID,
    PAYER_CATEGORY_CODE,
    PAYEE_USER_ID,
    PAYEE_CATEGORY_CODE,
    COMMISSION_AMOUNT,
    SERVICE_TYPE,
    TRANSFER_STATUS,
    TRANSFER_SUBTYPE,
    PAYER_DOMAIN_CODE,
    PAYER_GRADE_NAME,
    PAYER_MOBILE_GROUP_ROLE,
    PAYER_GROUP_ROLE,
    PAYER_MSISDN_ACC,
    PARENT_PAYER_USER_ID,
    PARENT_PAYER_USER_MSISDN,
    OWNER_PAYER_USER_ID,
    OWNER_PAYER_USER_MSISDN,
    PAYER_WALLET_NUMBER,
    PAYEE_DOMAIN_CODE,
    PAYEE_GRADE_NAME,
    PAYEE_MOBILE_GROUP_ROLE,
    PAYEE_GROUP_ROLE,
    PAYEE_MSISDN_ACC,
    PARENT_PAYEE_USER_ID,
    PARENT_PAYEE_USER_MSISDN,
    OWNER_PAYEE_USER_ID,
    OWNER_PAYEE_USER_MSISDN,
    PAYEE_WALLET_NUMBER,
	ORIGINAL_FILE_NAME,
	ORIGINAL_FILE_SIZE,
	ORIGINAL_FILE_LINE_COUNT,
	TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(SUBSTRING (ORIGINAL_FILE_NAME, 28, 8),'yyyyMMdd'))) ORIGINAL_FILE_DATE,
	CURRENT_TIMESTAMP() INSERT_DATE,
	TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(TRANSACTION_DATE,'dd/MM/yyyy HH:mm:ss'))) TRANSACTION_DATE,
	TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(SUBSTRING (ORIGINAL_FILE_NAME, 28, 8),'yyyyMMdd'))) FILE_DATE
FROM CDR.SPARK_TT_COMMISSIONS_DETAILS_HOURLY  C
LEFT JOIN (SELECT DISTINCT  ORIGINAL_FILE_NAME FILE_NAME FROM CDR.SPARK_IT_COMMISSIONS_DETAILS_HOURLY)T ON T.FILE_NAME=C.ORIGINAL_FILE_NAME
WHERE T.FILE_NAME IS NULL