CREATE EXTERNAL TABLE CDR.SPARK_TT_COMMISSIONS_DETAILS_HOURLY (
    ORIGINAL_FILE_NAME VARCHAR(200),
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    TRANSACTION_ID VARCHAR(50),
    TRANSACTION_DATE VARCHAR(50),
    COMMISSION_ID VARCHAR(50),
    TRANSACTION_AMOUNT DECIMAL(17,2),
    PAYER_USER_ID VARCHAR(50),
    PAYER_CATEGORY_CODE VARCHAR(50),
    PAYEE_USER_ID VARCHAR(50),
    PAYEE_CATEGORY_CODE VARCHAR(50),
    COMMISSION_AMOUNT DECIMAL(17,2),
    SERVICE_TYPE VARCHAR(50),
    TRANSFER_STATUS VARCHAR(50),
    TRANSFER_SUBTYPE VARCHAR(50),
    PAYER_DOMAIN_CODE VARCHAR(50),
    PAYER_GRADE_NAME VARCHAR(50),
    PAYER_MOBILE_GROUP_ROLE VARCHAR(50),
    PAYER_GROUP_ROLE VARCHAR(50),
    PAYER_MSISDN_ACC VARCHAR(50),
    PARENT_PAYER_USER_ID VARCHAR(50),
    PARENT_PAYER_USER_MSISDN VARCHAR(50),
    OWNER_PAYER_USER_ID VARCHAR(50),
    OWNER_PAYER_USER_MSISDN VARCHAR(50),
    PAYER_WALLET_NUMBER VARCHAR(50),
    PAYEE_DOMAIN_CODE VARCHAR(50),
    PAYEE_GRADE_NAME VARCHAR(50),
    PAYEE_MOBILE_GROUP_ROLE VARCHAR(50),
    PAYEE_GROUP_ROLE VARCHAR(50),
    PAYEE_MSISDN_ACC VARCHAR(50),
    PARENT_PAYEE_USER_ID VARCHAR(50),
    PARENT_PAYEE_USER_MSISDN VARCHAR(50),
    OWNER_PAYEE_USER_ID VARCHAR(50),
    OWNER_PAYEE_USER_MSISDN VARCHAR(50),
    PAYEE_WALLET_NUMBER VARCHAR(50)

)
COMMENT 'external tables-TT'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/PROD/TT/OM_HOURLY/CURRENT/COMMISSIONS'
TBLPROPERTIES ('serialization.null.format'='')
;


CREATE TABLE CDR.SPARK_IT_COMMISSIONS_DETAILS_HOURLY
(
    TRANSACTION_ID VARCHAR(50),
    NQ_TRANSACTION_DATE VARCHAR(50),
    COMMISSION_ID VARCHAR(50),
    TRANSACTION_AMOUNT DECIMAL(17,2),
    PAYER_USER_ID VARCHAR(50),
    PAYER_CATEGORY_CODE VARCHAR(50),
    PAYEE_USER_ID VARCHAR(50),
    PAYEE_CATEGORY_CODE VARCHAR(50),
    COMMISSION_AMOUNT DECIMAL(17,2),
    SERVICE_TYPE VARCHAR(50),
    TRANSFER_STATUS VARCHAR(50),
    TRANSFER_SUBTYPE VARCHAR(50),
    PAYER_DOMAIN_CODE VARCHAR(50),
    PAYER_GRADE_NAME VARCHAR(50),
    PAYER_MOBILE_GROUP_ROLE VARCHAR(50),
    PAYER_GROUP_ROLE VARCHAR(50),
    PAYER_MSISDN_ACC VARCHAR(50),
    PARENT_PAYER_USER_ID VARCHAR(50),
    PARENT_PAYER_USER_MSISDN VARCHAR(50),
    OWNER_PAYER_USER_ID VARCHAR(50),
    OWNER_PAYER_USER_MSISDN VARCHAR(50),
    PAYER_WALLET_NUMBER VARCHAR(50),
    PAYEE_DOMAIN_CODE VARCHAR(50),
    PAYEE_GRADE_NAME VARCHAR(50),
    PAYEE_MOBILE_GROUP_ROLE VARCHAR(50),
    PAYEE_GROUP_ROLE VARCHAR(50),
    PAYEE_MSISDN_ACC VARCHAR(50),
    PARENT_PAYEE_USER_ID VARCHAR(50),
    PARENT_PAYEE_USER_MSISDN VARCHAR(50),
    OWNER_PAYEE_USER_ID VARCHAR(50),
    OWNER_PAYEE_USER_MSISDN VARCHAR(50),
    PAYEE_WALLET_NUMBER VARCHAR(50),
    ORIGINAL_FILE_NAME  VARCHAR(50),
    ORIGINAL_FILE_SIZE  INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    ORIGINAL_FILE_DATE DATE,
    INSERT_DATE TIMESTAMP
   )
  PARTITIONED BY (TRANSACTION_DATE DATE, FILE_DATE DATE)
  STORED AS PARQUET
  TBLPROPERTIES ("parquet.compress"="SNAPPY");