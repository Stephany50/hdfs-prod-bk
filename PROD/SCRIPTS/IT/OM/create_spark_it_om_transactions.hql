CREATE TABLE CDR.SPARK_IT_OMNY_TRANSACTIONS
   (
    SENDER_MSISDN VARCHAR(100),
  RECEIVER_MSISDN VARCHAR(100),
  RECEIVER_USER_ID VARCHAR(100),
  SENDER_USER_ID VARCHAR(100),
  TRANSACTION_AMOUNT BIGINT,
  COMMISSIONS_PAID BIGINT,
  COMMISSIONS_RECEIVED BIGINT,
  COMMISSIONS_OTHERS BIGINT,
  SERVICE_CHARGE_RECEIVED BIGINT,
  SERVICE_CHARGE_PAID BIGINT,
  TAXES BIGINT,
  SERVICE_TYPE VARCHAR(100),
  TRANSFER_STATUS VARCHAR(100),
  SENDER_PRE_BAL BIGINT,
  SENDER_POST_BAL BIGINT,
  RECEIVER_PRE_BAL BIGINT,
  RECEIVER_POST_BAL BIGINT,
  SENDER_ACC_STATUS VARCHAR(50),
  RECEIVER_ACC_STATUS VARCHAR(50),
  ERROR_CODE VARCHAR(50),
  ERROR_DESC VARCHAR(1000),
  REFERENCE_NUMBER VARCHAR(50),
  CREATED_ON TIMESTAMP,
  CREATED_BY VARCHAR(50),
  MODIFIED_ON TIMESTAMP,
  MODIFIED_BY VARCHAR(50),
  APP_1_DATE TIMESTAMP,
  APP_2_DATE TIMESTAMP,
  TRANSFER_ID VARCHAR(50),
  TRANSFER_DATETIME_NQ TIMESTAMP,
  SENDER_CATEGORY_CODE VARCHAR(50),
  SENDER_DOMAIN_CODE VARCHAR(50),
  SENDER_GRADE_NAME VARCHAR(100),
  SENDER_GROUP_ROLE VARCHAR(50),
  SENDER_DESIGNATION VARCHAR(100),
  SENDER_STATE VARCHAR(100),
  RECEIVER_CATEGORY_CODE VARCHAR(50),
  RECEIVER_DOMAIN_CODE VARCHAR(50),
  RECEIVER_GRADE_NAME VARCHAR(100),
  RECEIVER_GROUP_ROLE VARCHAR(50),
  RECEIVER_DESIGNATION VARCHAR(100),
  RECEIVER_STATE VARCHAR(100),
  SENDER_CITY VARCHAR(50),
  RECEIVER_CITY VARCHAR(50),
  APP_1_BY VARCHAR(50),
  APP_2_BY VARCHAR(50),
  REQUEST_SOURCE VARCHAR(50),
  GATEWAY_TYPE VARCHAR(50),
  TRANSFER_SUBTYPE VARCHAR(100),
  PAYMENT_TYPE VARCHAR(100),
  PAYMENT_NUMBER VARCHAR(50),
  PAYMENT_DATE TIMESTAMP,
  REMARKS VARCHAR(500),
  ACTION_TYPE VARCHAR(50),
  TRANSACTION_TAG VARCHAR(100),
  RECONCILIATION_BY VARCHAR(50),
  RECONCILIATION_FOR VARCHAR(50),
  EXT_TXN_NUMBER VARCHAR(50),
  ORIGINAL_REF_NUMBER VARCHAR(50),
  ZEBRA_AMBIGUOUS VARCHAR(50),
  ATTEMPT_STATUS VARCHAR(50),
  OTHER_MSISDN VARCHAR(100),
  SENDER_WALLET_NUMBER VARCHAR(100),
  RECEIVER_WALLET_NUMBER VARCHAR(100),
  SENDER_USER_NAME VARCHAR(100),
  RECEIVER_USER_NAME VARCHAR(100),
  TNO_MSISDN VARCHAR(100),
  TNO_ID VARCHAR(100),
  UNREG_FIRST_NAME VARCHAR(100),
  UNREG_LAST_NAME VARCHAR(100),
  UNREG_DOB VARCHAR(100),
  UNREG_ID_NUMBER VARCHAR(50),
  BULK_PAYOUT_BATCHID VARCHAR(50),
  IS_FINANCIAL VARCHAR(50),
  TRANSFER_DONE VARCHAR(50),
  INITIATOR_MSISDN VARCHAR(50),
  VALIDATOR_MSISDN VARCHAR(50),
  INITIATOR_COMMENTS VARCHAR(1000),
  VALIDATOR_COMMENTS VARCHAR(1000),
  SENDER_WALLET_NAME VARCHAR(50),
  RECIEVER_WALLET_NAME VARCHAR(50),
  SENDER_USER_TYPE VARCHAR(50),
  RECEIVER_USER_TYPE VARCHAR(50),
  ORIGINAL_FILE_NAME VARCHAR(50),
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
  ORIGINAL_FILE_DATE DATE,
  INSERT_DATE TIMESTAMP
)
PARTITIONED BY (TRANSFER_DATETIME DATE, FILE_DATE DATE)
CLUSTERED BY(SENDER_MSISDN) INTO 64 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')

