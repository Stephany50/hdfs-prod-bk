INSERT INTO  CDR.IT_OMNY_SERVICES_CHARGES  PARTITION (START_DATE)
SELECT
ORIGINAL_FILE_NAME ,
ORIGINAL_FILE_SIZE ,
ORIGINAL_FILE_LINE_COUNT ,
SERVICE_CHARGE_ID ,
NETWORK_NAME ,
PROFILE_NAME ,
SHORT_CODE ,
SERVICE_TYPE ,
PAYER_GRADE_CODE ,
PAYEE_GRADE_CODE ,
SERVICE_CHARGE_VERSION ,
FROM_UNIXTIME(UNIX_TIMESTAMP(START_DATETIME,'dd/MM/yyyy HH:mm:ss')) START_DATETIME ,
MIN_TRANSFER_VALUE ,
MAX_TRANSFER_VALUE ,
MULTIPLE_OF ,
MIN_FIXED_SERVICE_CHARGE ,
MAX_FIXED_SERVICE_CHARGE ,
MIN_PCT_SERVICE_CHARGE ,
MAX_PCT_SERVICE_CHARGE ,
START_RANGE ,
END_RANGE ,
FIXED_SERVICE_CHARGE ,
PCT_SERVICE_CHARGE ,
CREATED_BY ,
FROM_UNIXTIME(UNIX_TIMESTAMP(CREATED_ON,'dd/MM/yyyy HH:mm:ss')) CREATED_ON ,
MODIFIED_BY ,
FROM_UNIXTIME(UNIX_TIMESTAMP(MODIFIED_ON,'dd/MM/yyyy HH:mm:ss')) MODIFIED_ON ,
PAYER_PAYMENT_TYPE_ID ,
PAYEE_PAYMENT_TYPE_ID ,
IS_FINANCIAL ,
SERVICE_CHARGE_NONFIN ,
STATUS_ID ,
PAYER_CATEGORY_CODE ,
PAYER_TYPE ,
CREDIT_ENTITY ,
DEBIT_ENTITY ,
SLAB_CODE ,
CURRENT_TIMESTAMP EINSERT_DATE ,
to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(START_DATETIME,'dd/MM/yyyy HH:mm:ss'))) START_DATE

FROM CDR.TT_OMNY_SERVICES_CHARGES  C
LEFT JOIN (SELECT DISTINCT original_file_name FILE_NAME FROM   CDR.IT_OMNY_SERVICES_CHARGES_DETAILS) T ON T.file_name = C.original_file_name
WHERE  T.file_name IS NULL;