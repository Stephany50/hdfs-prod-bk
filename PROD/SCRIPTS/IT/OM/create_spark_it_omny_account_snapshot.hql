CREATE TABLE IF NOT EXISTS CDR.SPARK_IT_OMNY_ACCOUNT_SNAPSHOT(
USER_NAME     VARCHAR(200),
LAST_NAME     VARCHAR(200),
CREATED_ON    TIMESTAMP,
MODIFIED_ON   TIMESTAMP,
LAST_TRANSFER_ON  DATE,
MSISDN  VARCHAR(25),
USER_ID VARCHAR(100),
BALANCE DECIMAL(17,2),
EXTERNAL_CODE VARCHAR(50),
IS_ACTIVE     VARCHAR(1),
BIRTH_DATE    DATE,
USER_TYPE     VARCHAR(50),
USER_DOMAIN   VARCHAR(50),
USER_CATEGORY VARCHAR(50),
ORIGINAL_FILE_NAME VARCHAR(50),
ORIGINAL_FILE_SIZE INT,
ORIGINAL_FILE_LINE_COUNT INT,
INSERT_DATE TIMESTAMP
)
PARTITIONED BY (ORIGINAL_FILE_DATE DATE)
CLUSTERED BY(USER_ID) INTO 8 BUCKETS
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')
