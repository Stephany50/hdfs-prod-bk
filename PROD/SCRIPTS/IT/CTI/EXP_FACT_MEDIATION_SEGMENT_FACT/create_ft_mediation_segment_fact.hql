
CREATE TABLE IF NOT EXISTS CTI.FT_MEDIATION_SEGMENT_FACT (
    MEDIATION_SEGMENT_ID   BIGINT,
    TENANT_KEY   BIGINT,
    START_DATE_TIME_KEY  BIGINT,
    END_DATE_TIME_KEY  BIGINT,
    INTERACTION_TYPE_KEY   BIGINT,
    MEDIA_TYPE_KEY   BIGINT,
    TECHNICAL_DESCRIPTOR_KEY   BIGINT,
    RESOURCE_KEY   BIGINT,
    RESOURCE_GROUP_COMBINATION_KEY   BIGINT,
    INTERACTION_ID   BIGINT,
    MEDIA_SERVER_IXN_GUID  VARCHAR(50),
    MEDIATION_GUID   VARCHAR(50),
    TARGET_IXN_RESOURCE_ID   BIGINT,
    MEDIATION_DURATION   BIGINT,
    ONLINE_DURATION  BIGINT,
    SHORT_ABANDONED_FLAG   INT,
    ANSWER_THRESHOLD   BIGINT,
    MET_THRESHOLD_FLAG   INT,
    ACTIVE_FLAG  INT,
    START_TS   BIGINT,
    END_TS   BIGINT,
    CREATE_AUDIT_KEY   BIGINT,
    UPDATE_AUDIT_KEY   BIGINT,
    ORIGINAL_FILE_NAME   VARCHAR(50),
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    ORIGINAL_FILE_DATE   DATE,
    INSERT_DATE  TIMESTAMP
)
CLUSTERED BY(ORIGINAL_FILE_DATE) INTO 64 BUCKETS
STORED AS ORC
TBLPROPERTIES ('transactional'='true',"orc.compress"="ZLIB","orc.stripe.size"="67108864");
