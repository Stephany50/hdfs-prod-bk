INSERT INTO  CTI.DT_INTERACTION_RESOURCE_STATE
SELECT
INTERACTION_RESOURCE_STATE_KEY ,   
CREATE_AUDIT_KEY               ,   
UPDATE_AUDIT_KEY               ,   
STATE_NAME                     , 
STATE_NAME_CODE                , 
STATE_ROLE                     , 
STATE_ROLE_CODE                , 
STATE_DESCRIPTOR               , 
STATE_DESCRIPTOR_CODE          , 
PURGE_FLAG                     ,
ORIGINAL_FILE_NAME             ,
ORIGINAL_FILE_SIZE             ,
ORIGINAL_FILE_LINE_COUNT       ,
TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(SUBSTRING (ORIGINAL_FILE_NAME, -12, 8),'yyyyMMdd'))) ORIGINAL_FILE_DATE,
CURRENT_TIMESTAMP() INSERT_DATE
FROM CTI.TT_DT_INTERACTION_RESOURCE_STATE C
LEFT JOIN (SELECT DISTINCT  ORIGINAL_FILE_NAME FILE_NAME FROM  CTI.DT_INTERACTION_RESOURCE_STATE)T ON T.FILE_NAME=C.ORIGINAL_FILE_NAME
WHERE T.FILE_NAME IS NULL;
