
CREATE TABLE CTI.IT_INTERACTION_RESOURCE_FACT(

INTERACTION_RESOURCE_ID              BIGINT,
TENANT_KEY                           INT   ,
INTERACTION_TYPE_KEY                 INT   ,
MEDIA_TYPE_KEY                       INT   ,
TECHNICAL_DESCRIPTOR_KEY             INT   ,
MEDIA_RESOURCE_KEY                   INT   ,
RESOURCE_GROUP_COMBINATION_KEY       INT   ,
PLACE_KEY                            INT   ,
STRATEGY_KEY                         INT   ,
ROUTING_TARGET_KEY                   INT   ,
REQUESTED_SKILL_KEY                  INT   ,
INTERACTION_ID                       BIGINT ,
RES_PREVIOUS_SM_STATE_KEY            INT   ,
RES_PREVIOUS_SM_STATE_FACT_KEY       BIGINT ,
RESOURCE_KEY                         INT   ,
LAST_RP_RESOURCE_KEY                 INT   ,
LAST_QUEUE_RESOURCE_KEY              INT   ,
LAST_VQUEUE_RESOURCE_KEY             INT   ,
LAST_IVR_RESOURCE_KEY                INT   ,
PREV_IRF_ID                          BIGINT ,
MEDIATION_SEGMENT_ID                 BIGINT  ,
MEDIATION_RESOURCE_KEY               INT   ,
MEDIATION_START_DATE_TIME_KEY        INT   ,
INTERACTION_RESOURCE_ORDINAL         INT    ,
IRF_ANCHOR                           INT    ,
IRF_ANCHOR_DATE_TIME_KEY             INT   ,
LAST_INTERACTION_RESOURCE            INT    ,
PARTYGUID                            VARCHAR(50),
LEAD_CLIP_DURATION                   INT   ,
TRAIL_CLIP_DURATION                  INT   ,
ROUTING_POINT_DURATION               INT   ,
QUEUE_DURATION                       INT   ,
IVR_PORT_DURATION                    INT   ,
HANDLE_COUNT                         INT    ,
CUSTOMER_HANDLE_COUNT                INT    ,
PREVIOUS_MEDIATION_DURATION          INT   ,
MEDIATION_DURATION                   INT   ,
MEDIATION_COUNT                      INT    ,
MET_SERVICE_OBJECTIVE_FLAG           INT    ,
SHORT_ABANDONED_FLAG                 INT    ,
STOP_ACTION                          INT    ,
DIAL_COUNT                           INT    ,
DIAL_DURATION                        INT   ,
RING_COUNT                           INT    ,
RING_DURATION                        INT   ,
TALK_COUNT                           INT    ,
TALK_DURATION                        INT   ,
HOLD_COUNT                           INT    ,
HOLD_DURATION                        INT   ,
AFTER_CALL_WORK_COUNT                INT    ,
AFTER_CALL_WORK_DURATION             INT   ,
CUSTOMER_DIAL_COUNT                  INT    ,
CUSTOMER_DIAL_DURATION               INT   ,
CUSTOMER_RING_COUNT                  INT    ,
CUSTOMER_RING_DURATION               INT   ,
CUSTOMER_TALK_COUNT                  INT    ,
CUSTOMER_TALK_DURATION               INT   ,
CUSTOMER_HOLD_COUNT                  INT    ,
CUSTOMER_HOLD_DURATION               INT   ,
CUSTOMER_ACW_COUNT                   INT    ,
CUSTOMER_ACW_DURATION                INT   ,
POST_CONS_XFER_TALK_COUNT            INT    ,
POST_CONS_XFER_TALK_DURATION         INT   ,
POST_CONS_XFER_HOLD_COUNT            INT    ,
POST_CONS_XFER_HOLD_DURATION         INT   ,
POST_CONS_XFER_RING_COUNT            INT    ,
POST_CONS_XFER_RING_DURATION         INT   ,
CONF_INIT_TALK_COUNT                 INT    ,
CONF_INIT_TALK_DURATION              INT   ,
CONF_INIT_HOLD_COUNT                 INT    ,
CONF_INIT_HOLD_DURATION              INT   ,
CONF_JOIN_RING_COUNT                 INT    ,
CONF_JOIN_RING_DURATION              INT   ,
CONF_JOIN_TALK_COUNT                 INT    ,
CONF_JOIN_TALK_DURATION              INT   ,
CONF_JOIN_HOLD_COUNT                 INT    ,
CONF_JOIN_HOLD_DURATION              INT   ,
CONFERENCE_INITIATED_COUNT           INT    ,
CONS_INIT_DIAL_COUNT                 INT    ,
CONS_INIT_DIAL_DURATION              INT   ,
CONS_INIT_TALK_COUNT                 INT    ,
CONS_INIT_TALK_DURATION              INT   ,
CONS_INIT_HOLD_COUNT                 INT    ,
CONS_INIT_HOLD_DURATION              INT   ,
CONS_RCV_RING_COUNT                  INT    ,
CONS_RCV_RING_DURATION               INT   ,
CONS_RCV_TALK_COUNT                  INT    ,
CONS_RCV_TALK_DURATION               INT   ,
CONS_RCV_HOLD_COUNT                  INT    ,
CONS_RCV_HOLD_DURATION               INT   ,
CONS_RCV_ACW_COUNT                   INT    ,
CONS_RCV_ACW_DURATION                INT   ,
AGENT_TO_AGENT_CONS_COUNT            INT    ,
AGENT_TO_AGENT_CONS_DURATION         INT   ,
CREATE_AUDIT_KEY                     BIGINT ,
UPDATE_AUDIT_KEY                     BIGINT  ,
START_DATE_TIME_KEY                  INT   ,
END_DATE_TIME_KEY                    INT   ,
START_TS                             INT   ,
END_TS                               INT   ,
ACTIVE_FLAG                          INT    ,
PURGE_FLAG                           INT    ,
ORIGINAL_FILE_NAME                   VARCHAR(50),
ORIGINAL_FILE_DATE                   DATE        ,
ORIGINAL_FILE_SIZE                   INT,
ORIGINAL_FILE_LINE_COUNT             INT,
INSERT_DATE                          DATE
)
CLUSTERED BY(ORIGINAL_FILE_DATE) INTO 64 BUCKETS
STORED AS ORC
TBLPROPERTIES ('transactional'='true',"orc.compress"="ZLIB","orc.stripe.size"="67108864")
;