CREATE TABLE CDR.SPARK_IT_BILLING_DOC (
ORIGINAL_FILE_NAME VARCHAR(150),
ORIGINAL_FILE_SIZE INT,
ORIGINAL_FILE_LINE_COUNT INT,
ACCOUNT_NUMBER  VARCHAR(100),
CUSTOMER_NAME   VARCHAR(255),
ACCOUNT_NAME    VARCHAR(255),
CURRENT_BALANCE VARCHAR(255),
DOCUMENT_NUMBER VARCHAR(255),
BILLING_CYCLE   VARCHAR(255),
DOCUMENT_TYPE   VARCHAR(255),
DOCUMENT_DATE   VARCHAR(255),
OPERATOR        VARCHAR(255),
TOTAL_AMOUNT    VARCHAR(255),
OPEN_AMOUNT     VARCHAR(255),
DOCUMENT_UPDATE_DATE VARCHAR(255),
INSERT_DATE TIMESTAMP,
ORIGINAL_FILE_DATE    DATE
)
PARTITIONED BY (AS_OF_DATE DATE)
STORED AS PARQUET TBLPROPERTIES ("parquet.compress"="SNAPPY")



CREATE EXTERNAL TABLE CDR.TT_BILLING_DOC (
ORIGINAL_FILE_NAME VARCHAR(150),
ORIGINAL_FILE_SIZE INT,
ORIGINAL_FILE_LINE_COUNT INT,
ACCOUNT_NUMBER  VARCHAR(100),
CUSTOMER_NAME   VARCHAR(255),
ACCOUNT_NAME    VARCHAR(255),
CURRENT_BALANCE VARCHAR(255),
DOCUMENT_NUMBER VARCHAR(255),
BILLING_CYCLE   VARCHAR(255),
DOCUMENT_TYPE   VARCHAR(255),
DOCUMENT_DATE   VARCHAR(255),
OPERATOR        VARCHAR(255),
TOTAL_AMOUNT    VARCHAR(255),
OPEN_AMOUNT     VARCHAR(255),
DOCUMENT_UPDATE_DATE VARCHAR(255),
INSERT_DATE TIMESTAMP,
ORIGINAL_FILE_DATE    DATE
)
COMMENT 'external tables-TT'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/PROD/TT/STAT_TOOLS/RECOUVREMENT_CREANCES'
TBLPROPERTIES ('serialization.null.format'='');