SELECT
    transaction_date
    , SUBSTR(TRANSACTION_TIME, 1, 2) heure
    , MAX(SERVED_PARTY_LOCATION) location_msisdn_a
    , TRANSACTION_TYPE type
    , TRANSACTION_DIRECTION sens
    , SERVED_MSISDN msisdn_a
    , MAX(SERVED_IMEI) imei_a                
    , OTHER_PARTY msisdn_b
    , SUM(NVL(TRANSACTION_DURATION, 0)) duree  
    , COUNT(1) nombre
FROM MON.SPARK_FT_MSC_TRANSACTION
WHERE TRANSACTION_DATE = '###SLICE_VALUE###'
GROUP BY TRANSACTION_DATE
    , SUBSTR(TRANSACTION_TIME, 1, 2)
    , TRANSACTION_TYPE
    , TRANSACTION_DIRECTION
    , SERVED_MSISDN
    , OTHER_PARTY