SELECT
    TRANSACTION_DATE
    , SUBSTR(TRANSACTION_TIME, 1, 2) HEURE
    , MAX(SERVED_PARTY_LOCATION) LOCATION_MSISDN_A
    , TRANSACTION_TYPE TYPE
    , TRANSACTION_DIRECTION SENS
    , SERVED_MSISDN MSISDN_A
    , MAX(SERVED_IMEI) IMEI_A                
    , OTHER_PARTY MSISDN_B
    , SUM(NVL(TRANSACTION_DURATION, 0)) DUREE  
    , COUNT(1) NOMBRE
FROM MON.SPARK_FT_MSC_TRANSACTION
WHERE TRANSACTION_DATE = '###SLICE_VALUE###'
GROUP BY TRANSACTION_DATE
    , SUBSTR(TRANSACTION_TIME, 1, 2)
    , TRANSACTION_TYPE
    , TRANSACTION_DIRECTION
    , SERVED_MSISDN
    , OTHER_PARTY