SELECT IF( 
    T_1.KPI_EXIST > 0 AND 
    T_2.KPI_EXIST > 0 AND 
    T_3.KPI_EXIST > 0 AND 
    T_4.KPI_EXIST > 0 AND 
    T_5.KPI_EXIST > 0 AND 
    T_6.KPI_EXIST > 0 AND 
    T_7.KPI_EXIST > 0 AND 
    T_8.KPI_EXIST > 0 AND 
    T_8.KPI_EXIST > 0 AND 
    T_9.KPI_EXIST > 0 AND 
    T_10.KPI_EXIST > 0 AND 
    T_11.KPI_EXIST > 0 AND 
    T_12.KPI_EXIST > 0 AND 
    T_13.KPI_EXIST > 0 AND 
    T_14.KPI_EXIST > 0 AND 
    T_15.KPI_EXIST > 0 AND 
    T_16.KPI_EXIST > 0 AND 
    T_17.KPI_EXIST > 0 AND 
    T_18.KPI_EXIST > 0 AND 
    T_19.KPI_EXIST > 0 AND 
    T_20.KPI_EXIST > 0 AND 
    T_21.KPI_EXIST > 0 AND 
    T_22.KPI_EXIST > 0 AND 
    T_23.KPI_EXIST > 0 AND 
    T_24.KPI_EXIST > 0 AND 
    T_25.NB_EXPORT < 1 ,"OK","NOK")
FROM
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='TELCO_LOANS_DELAY') T_1,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='ATC_LOANS_AMT') T_2,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_DEPOSIT_AMT') T_3,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_DEPOSIT_QTY') T_4,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_RECV_AMT') T_5,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_RECV_QTY') T_6,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='CALLS_ON_N') T_7,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_AMT_SALARY') T_8,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='BANK_OM_TRF_AMT') T_9,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='BANK_OM_TRF_QTY') T_10,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_BANK_TRF_AMT') T_11,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_BANK_TRF_QTY') T_12,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_INC_AMT') T_13,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_INC_QTY') T_14,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_B2C_RECV_AMT') T_15,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='OM_B2C_RECV_QTY') T_16,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='ATC_LOANS_QTY') T_17,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='TELCO_CR') T_18,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='CALLS_OFF_N') T_19,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='CALLS_ON_D') T_20,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='CALLS_OFF_D') T_21,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='SMS_ON') T_22,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='SMS_OFF') T_23,
(SELECT COUNT(*) KPI_EXIST FROM MON.SPARK_TT_PICO_KPIS WHERE EVENT_MONTH ='###SLICE_VALUE###' and KPI='TELCO_CR_N') T_24,
(select COUNT(*) NB_EXPORT FROM (SELECT * FROM (SELECT * FROM MON.EXPORT_HISTORY WHERE EVENT_DATE='###SLICE_VALUE##-01' AND JOB_INSTANCEID='${hivevar:job_instanceid}' ORDER BY INSERT_DATE DESC LIMIT 1)  T WHERE T.STATUS = 'OK') M) T_25







