CREATE TABLE MON.SPARK_FT_RECHARGE_BY_RETAILER_MONTH
(
MSISDN VARCHAR(25),
CANAUX VARCHAR(50),
DIRECTION CHAR(3),
EVENT VARCHAR(25),
CANAL_TYPE VARCHAR(50),
CANAL_EVENT VARCHAR(50),
AMOUNT DECIMAL(17, 2),
COMMISSION DECIMAL(17, 2),
REVENUE DECIMAL(17, 2),
TRANSACTION_COUNT DECIMAL(17, 2),
OTHER_PARTY_COUNT DECIMAL(17, 2),
SOURCE CHAR(9),
INSERT_DATE TIMESTAMP,
CATEGORY_POS VARCHAR(10)
)
PARTITIONED BY (EVENT_MONTH VARCHAR(6))
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')