CREATE TABLE MON.FT_CONSO_MSISDN_DAY
(
  MSISDN                          VARCHAR(25),
  FORMULE                         VARCHAR(70),
  CONSO                           DECIMAL(17,2),
  SMS_COUNT                       DECIMAL(17,2),
  TEL_COUNT                       DECIMAL(17,2),
  TEL_DURATION                    DECIMAL(17,2),
  BILLED_SMS_COUNT                DECIMAL(17,2),
  BILLED_TEL_COUNT                DECIMAL(17,2),
  BILLED_TEL_DURATION             DECIMAL(17,2),
  CONSO_SMS                       DECIMAL(17,2),
  CONSO_TEL                       DECIMAL(17,2),
  PROMOTIONAL_CALL_COST           DECIMAL(17,2),
  MAIN_CALL_COST                  DECIMAL(17,2),
  SRC_TABLE                       VARCHAR(30),
  OTHERS_VAS_TOTAL_COUNT          DECIMAL(17,2),
  OTHERS_VAS_DURATION             DECIMAL(17,2),
  OTHERS_VAS_MAIN_COST            DECIMAL(17,2),
  OTHERS_VAS_PROMO_COST           DECIMAL(17,2),
  NATIONAL_TOTAL_COUNT            DECIMAL(17,2),
  NATIONAL_SMS_COUNT              DECIMAL(17,2),
  NATIONAL_DURATION               DECIMAL(17,2),
  NATIONAL_MAIN_COST              DECIMAL(17,2),
  NATIONAL_PROMO_COST             DECIMAL(17,2),
  NATIONAL_SMS_MAIN_COST          DECIMAL(17,2),
  NATIONAL_SMS_PROMO_COST         DECIMAL(17,2),
  MTN_TOTAL_COUNT                 DECIMAL(17,2),
  MTN_SMS_COUNT                   DECIMAL(17,2),
  MTN_DURATION                    DECIMAL(17,2),
  MTN_TOTAL_CONSO                 DECIMAL(17,2),
  MTN_SMS_CONSO                   DECIMAL(17,2),
  CAMTEL_TOTAL_COUNT              DECIMAL(17,2),
  CAMTEL_SMS_COUNT                DECIMAL(17,2),
  CAMTEL_DURATION                 DECIMAL(17,2),
  CAMTEL_TOTAL_CONSO              DECIMAL(17,2),
  CAMTEL_SMS_CONSO                DECIMAL(17,2),
  INTERNATIONAL_TOTAL_COUNT       DECIMAL(17,2),
  INTERNATIONAL_SMS_COUNT         DECIMAL(17,2),
  INTERNATIONAL_DURATION          DECIMAL(17,2),
  INTERNATIONAL_TOTAL_CONSO       DECIMAL(17,2),
  INTERNATIONAL_SMS_CONSO         DECIMAL(17,2),
  ONNET_SMS_COUNT                 DECIMAL(17,2),
  ONNET_DURATION                  DECIMAL(17,2),
  ONNET_TOTAL_CONSO               DECIMAL(17,2),
  ONNET_MAIN_CONSO                DECIMAL(17,2),
  ONNET_MAIN_TEL_CONSO            DECIMAL(17,2),
  ONNET_PROMO_TEL_CONSO           DECIMAL(17,2),
  ONNET_SMS_CONSO                 DECIMAL(17,2),
  MTN_MAIN_CONSO                  DECIMAL(17,2),
  CAMTEL_MAIN_CONSO               DECIMAL(17,2),
  SET_TOTAL_COUNT                 DECIMAL(17,2),
  SET_SMS_COUNT                   DECIMAL(17,2),
  SET_DURATION                    DECIMAL(17,2),
  SET_TOTAL_CONSO                 DECIMAL(17,2),
  SET_SMS_CONSO                   DECIMAL(17,2),
  SET_MAIN_CONSO                  DECIMAL(17,2),
  INTERNATIONAL_MAIN_CONSO        DECIMAL(17,2),
  ROAM_TOTAL_COUNT                DECIMAL(17,2),
  ROAM_SMS_COUNT                  DECIMAL(17,2),
  ROAM_DURATION                   DECIMAL(17,2),
  ROAM_TOTAL_CONSO                DECIMAL(17,2),
  ROAM_MAIN_CONSO                 DECIMAL(17,2),
  ROAM_SMS_CONSO                  DECIMAL(17,2),
  INROAM_TOTAL_COUNT              DECIMAL(17,2),
  INROAM_SMS_COUNT                DECIMAL(17,2),
  INROAM_DURATION                 DECIMAL(17,2),
  INROAM_TOTAL_CONSO              DECIMAL(17,2),
  INROAM_MAIN_CONSO               DECIMAL(17,2),
  INROAM_SMS_CONSO                DECIMAL(17,2),
  OPERATOR_CODE                   VARCHAR(50),
  NEXTTEL_TOTAL_COUNT             DECIMAL(17,2),
  NEXTTEL_SMS_COUNT               DECIMAL(17,2),
  NEXTTEL_DURATION                DECIMAL(17,2),
  NEXTTEL_TOTAL_CONSO             DECIMAL(17,2),
  NEXTTEL_SMS_CONSO               DECIMAL(17,2),
  NEXTTEL_MAIN_CONSO              DECIMAL(17,2),
  BUNDLE_SMS_COUNT                DECIMAL(17,2),
  BUNDLE_TEL_DURATION             DECIMAL(17,2),
  SET_MAIN_TEL_CONSO              DECIMAL(17,2),
  MTN_MAIN_TEL_CONSO              DECIMAL(17,2),
  NEXTTEL_MAIN_TEL_CONSO          DECIMAL(17,2),
  CAMTEL_MAIN_TEL_CONSO           DECIMAL(17,2),
  INTERNATIONAL_MAIN_TEL_CONSO    DECIMAL(17,2),
  SET_PROMO_TEL_CONSO             DECIMAL(17,2),
  MTN_PROMO_TEL_CONSO             DECIMAL(17,2),
  NEXTTEL_PROMO_TEL_CONSO         DECIMAL(17,2),
  CAMTEL_PROMO_TEL_CONSO          DECIMAL(17,2),
  INTERNATIONAL_PROMO_TEL_CONSO   DECIMAL(17,2),
  ROAM_MAIN_TEL_CONSO             DECIMAL(17,2),
  INROAM_MAIN_TEL_CONSO           DECIMAL(17,2),
  ROAM_PROMO_TEL_CONSO            DECIMAL(17,2),
  INROAM_PROMO_TEL_CONSO          DECIMAL(17,2),
  ONNET_BILLED_TEL_DURATION       DECIMAL(17,2),
  SET_BILLED_TEL_DURATION         DECIMAL(17,2),
  MTN_BILLED_TEL_DURATION         DECIMAL(17,2),
  NEXTTEL_BILLED_TEL_DURATION     DECIMAL(17,2),
  CAMTEL_BILLED_TEL_DURATION      DECIMAL(17,2),
  INTERNATIONAL_BIL_TEL_DURATION  DECIMAL(17,2),
  ROAM_BILLED_TEL_DURATION        DECIMAL(17,2),
  INROAM_BILLED_TEL_DURATION      DECIMAL(17,2),
  ONNET_BILLED_TEL_COUNT          DECIMAL(17,2),
  SET_BILLED_TEL_COUNT            DECIMAL(17,2),
  MTN_BILLED_TEL_COUNT            DECIMAL(17,2),
  NEXTTEL_BILLED_TEL_COUNT        DECIMAL(17,2),
  CAMTEL_BILLED_TEL_COUNT         DECIMAL(17,2),
  INTERNATIONAL_BILLED_TEL_COUNT  DECIMAL(17,2),
  ROAM_BILLED_TEL_COUNT           DECIMAL(17,2),
  INROAM_BILLED_TEL_COUNT         DECIMAL(17,2),
  ONNET_TEL_COUNT                 DECIMAL(17,2),
  SET_TEL_COUNT                   DECIMAL(17,2),
  MTN_TEL_COUNT                   DECIMAL(17,2),
  NEXTTEL_TEL_COUNT               DECIMAL(17,2),
  CAMTEL_TEL_COUNT                DECIMAL(17,2),
  INTERNATIONAL_TEL_COUNT         DECIMAL(17,2),
  ROAM_TEL_COUNT                  DECIMAL(17,2),
  INROAM_TEL_COUNT                DECIMAL(17,2),
  CONSO_TEL_MAIN                  DECIMAL(17,2),
  SVA_COUNT                       DECIMAL(17,2),
  SVA_DURATION                    DECIMAL(17,2),
  SVA_MAIN_CONSO                  DECIMAL(17,2),
  SVA_PROMO_CONSO                 DECIMAL(17,2),
  SVA_TEL_COUNT                   DECIMAL(17,2),
  SVA_BILLED_DURATION             DECIMAL(17,2),
  SVA_BILLED_TEL_CONSO            DECIMAL(17,2),
  SVA_SMS_COUNT                   DECIMAL(17,2),
  SVA_SMS_CONSO                   DECIMAL(17,2),
  INSERT_DATE                     TIMESTAMP
)
PARTITIONED BY (EVENT_DATE DATE)
TBLPROPERTIES ("orc.compress"="ZLIB","orc.stripe.size"="67108864")


INSERT INTO TMP.FT_CONSO_MSISDN_DAY
SELECT
    MSISDN,
    FORMULE,
    CONSO,
    SMS_COUNT,
    TEL_COUNT,
    TEL_DURATION,
    BILLED_SMS_COUNT,
    BILLED_TEL_COUNT,
    BILLED_TEL_DURATION,
    CONSO_SMS,
    CONSO_TEL,
    PROMOTIONAL_CALL_COST,
    MAIN_CALL_COST,
    SRC_TABLE,
    OTHERS_VAS_TOTAL_COUNT,
    OTHERS_VAS_DURATION,
    OTHERS_VAS_MAIN_COST,
    OTHERS_VAS_PROMO_COST,
    NATIONAL_TOTAL_COUNT,
    NATIONAL_SMS_COUNT,
    NATIONAL_DURATION,
    NATIONAL_MAIN_COST,
    NATIONAL_PROMO_COST,
    NATIONAL_SMS_MAIN_COST,
    NATIONAL_SMS_PROMO_COST,
    MTN_TOTAL_COUNT,
    MTN_SMS_COUNT,
    MTN_DURATION,
    MTN_TOTAL_CONSO,
    MTN_SMS_CONSO,
    CAMTEL_TOTAL_COUNT,
    CAMTEL_SMS_COUNT,
    CAMTEL_DURATION,
    CAMTEL_TOTAL_CONSO,
    CAMTEL_SMS_CONSO,
    INTERNATIONAL_TOTAL_COUNT,
    INTERNATIONAL_SMS_COUNT,
    INTERNATIONAL_DURATION,
    INTERNATIONAL_TOTAL_CONSO,
    INTERNATIONAL_SMS_CONSO,
    ONNET_SMS_COUNT,
    ONNET_DURATION,
    ONNET_TOTAL_CONSO,
    ONNET_MAIN_CONSO,
    ONNET_MAIN_TEL_CONSO,
    ONNET_PROMO_TEL_CONSO,
    ONNET_SMS_CONSO,
    MTN_MAIN_CONSO,
    CAMTEL_MAIN_CONSO,
    SET_TOTAL_COUNT,
    SET_SMS_COUNT,
    SET_DURATION,
    SET_TOTAL_CONSO,
    SET_SMS_CONSO,
    SET_MAIN_CONSO,
    INTERNATIONAL_MAIN_CONSO,
    ROAM_TOTAL_COUNT,
    ROAM_SMS_COUNT,
    ROAM_DURATION,
    ROAM_TOTAL_CONSO,
    ROAM_MAIN_CONSO,
    ROAM_SMS_CONSO,
    INROAM_TOTAL_COUNT,
    INROAM_SMS_COUNT,
    INROAM_DURATION,
    INROAM_TOTAL_CONSO,
    INROAM_MAIN_CONSO,
    INROAM_SMS_CONSO,
    OPERATOR_CODE,
    NEXTTEL_TOTAL_COUNT,
    NEXTTEL_SMS_COUNT,
    NEXTTEL_DURATION,
    NEXTTEL_TOTAL_CONSO,
    NEXTTEL_SMS_CONSO,
    NEXTTEL_MAIN_CONSO,
    BUNDLE_SMS_COUNT,
    BUNDLE_TEL_DURATION,
    SET_MAIN_TEL_CONSO,
    MTN_MAIN_TEL_CONSO,
    NEXTTEL_MAIN_TEL_CONSO,
    CAMTEL_MAIN_TEL_CONSO,
    INTERNATIONAL_MAIN_TEL_CONSO,
    SET_PROMO_TEL_CONSO,
    MTN_PROMO_TEL_CONSO,
    NEXTTEL_PROMO_TEL_CONSO,
    CAMTEL_PROMO_TEL_CONSO,
    INTERNATIONAL_PROMO_TEL_CONSO,
    ROAM_MAIN_TEL_CONSO,
    INROAM_MAIN_TEL_CONSO,
    ROAM_PROMO_TEL_CONSO,
    INROAM_PROMO_TEL_CONSO,
    ONNET_BILLED_TEL_DURATION,
    SET_BILLED_TEL_DURATION,
    MTN_BILLED_TEL_DURATION,
    NEXTTEL_BILLED_TEL_DURATION,
    CAMTEL_BILLED_TEL_DURATION,
    INTERNATIONAL_BIL_TEL_DURATION,
    ROAM_BILLED_TEL_DURATION,
    INROAM_BILLED_TEL_DURATION,
    ONNET_BILLED_TEL_COUNT,
    SET_BILLED_TEL_COUNT,
    MTN_BILLED_TEL_COUNT,
    NEXTTEL_BILLED_TEL_COUNT,
    CAMTEL_BILLED_TEL_COUNT,
    INTERNATIONAL_BILLED_TEL_COUNT,
    ROAM_BILLED_TEL_COUNT,
    INROAM_BILLED_TEL_COUNT,
    ONNET_TEL_COUNT,
    SET_TEL_COUNT,
    MTN_TEL_COUNT,
    NEXTTEL_TEL_COUNT,
    CAMTEL_TEL_COUNT,
    INTERNATIONAL_TEL_COUNT,
    ROAM_TEL_COUNT,
    INROAM_TEL_COUNT,
    CONSO_TEL_MAIN,
    SVA_COUNT,
    SVA_DURATION,
    SVA_MAIN_CONSO,
    SVA_PROMO_CONSO,
    SVA_TEL_COUNT,
    SVA_BILLED_DURATION,
    SVA_BILLED_TEL_CONSO,
    SVA_SMS_COUNT,
    SVA_SMS_CONSO,
    INSERT_DATE,
    TO_DATE(EVENT_DATE)
FROM BACKUP_DWH.FT_CONSO_MSISDN_DAY