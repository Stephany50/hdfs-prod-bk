INSERT INTO MON.SPARK_FT_MSISDN_IMEI_DATA_LOCATION
SELECT
    SERVED_PARTY_MSISDN
    , SERVED_PARTY_IMSI
    , SERVED_PARTY_IMEI
    , LOCATION_MCC
    , LOCATION_MNC
    , LOCATION_LAC
    , LOCATION_CI
    , SUM(BYTES_SENT) BYTES_SENT
    , SUM(BYTES_RECEIVED) BYTES_RECEIVED
    , round(SUM(TOTAL_COST), 2) TOTAL_COST
    , SUM(SESSION_DURATION) SESSION_DURATION
    , round(SUM(MAIN_COST), 2) MAIN_COST
    , round(SUM(PROMO_COST), 2) PROMO_COST
    , SUM(BUNDLE_BYTES_USED_VOLUME) BUNDLE_BYTES_USED_VOLUME
    , SUM(BUNDLE_MMS_USED_VOLUME) BUNDLE_MMS_USED_VOLUME
    , SUM(1) TOTAL_COUNT
    , SUM(CASE WHEN TOTAL_COST > 0 THEN 1 ELSE 0 END) RATED_COUNT
    , 'FT_CRA_GPRS' SOURCE_TYPE
    , CURRENT_TIMESTAMP() INSERT_DATE
    , SESSION_DATE
FROM MON.SPARK_FT_CRA_GPRS
WHERE SESSION_DATE = "###SLICE_VALUE###"
GROUP BY SESSION_DATE, SERVED_PARTY_MSISDN, SERVED_PARTY_IMSI, SERVED_PARTY_IMEI, LOCATION_MCC, LOCATION_MNC, LOCATION_LAC, LOCATION_CI