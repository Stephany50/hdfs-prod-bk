SELECT IF(T_1.FT_A_COUNT = 0 and T_2.FT_COUNT > 1000 and ft_client_last_site_day>0 AND T_4.NB_INSERT_DATE1= 1 ,"OK","NOK") EXTRACT_EXIST
FROM
(SELECT COUNT(*) FT_A_COUNT FROM AGG.SPARK_FT_A_SUBSCRIPTION WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_1,
(SELECT COUNT(*) FT_COUNT FROM MON.SPARK_FT_SUBSCRIPTION WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_2,
(SELECT COUNT(*) ft_client_last_site_day FROM MON.spark_ft_client_last_site_day WHERE  event_date between date_sub('###SLICE_VALUE###',7) and '###SLICE_VALUE###') T_3,
(SELECT COUNT(distinct insert_date) NB_INSERT_DATE1 FROM MON.SPARK_FT_SUBSCRIPTION WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_4