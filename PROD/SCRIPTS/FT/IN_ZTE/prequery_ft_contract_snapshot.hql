SELECT IF(
  A.FT_EXIST = 0
  AND B.PRE_FT_EXIST > 0
  AND C.ACC_NBR_EXIST > 0
  AND D.SUBS_EXIST > 0
  AND E.PROD_EXIST > 0
 -- AND F.PRICE_PLAN_EXIST > 0
  AND G.ACCT_EXIST > 0
  AND H.BAL_EXIST > 0,
  "OK","NOK") RESULT
FROM
(SELECT COUNT(*) FT_EXIST FROM MON.FT_CONTRACT_SNAPSHOT WHERE EVENT_DATE = '###SLICE_VALUE###') A,
(SELECT COUNT(*) PRE_FT_EXIST FROM MON.FT_CONTRACT_SNAPSHOT WHERE EVENT_DATE = DATE_SUB(TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP('###SLICE_VALUE###', 'yyyy-MM-dd'))), 1)) B,
(SELECT COUNT(*) ACC_NBR_EXIST FROM CDR.IT_ZTE_ACC_NBR_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') C,
(SELECT COUNT(*) SUBS_EXIST FROM CDR.IT_ZTE_SUBS_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') D,
(SELECT COUNT(*) PROD_EXIST FROM CDR.IT_ZTE_PROD_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') E,
--(SELECT COUNT(*) PRICE_PLAN_EXIST FROM CDR.IT_ZTE_PRICE_PLAN_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') F,
(SELECT COUNT(*) ACCT_EXIST FROM CDR.IT_ZTE_ACCT_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') G,
(SELECT COUNT(*) BAL_EXIST FROM CDR.IT_ZTE_BAL_EXTRACT WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###') H
