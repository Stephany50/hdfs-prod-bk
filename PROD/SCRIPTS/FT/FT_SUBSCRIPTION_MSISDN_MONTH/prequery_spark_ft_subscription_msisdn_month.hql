SELECT IF(A.FT_EXIST = 0 AND B.FT_COUNT > DATEDIFF(LAST_DAY('###SLICE_VALUE###'||'-01') , '###SLICE_VALUE###'||'-01') AND C.FT_COUNT>0 , "OK","NOK") FROM
(SELECT COUNT(*) FT_EXIST FROM MON.SPARK_FT_SUBSCRIPTION_MSISDN_MONTH WHERE EVENT_MONTH='###SLICE_VALUE###') A,
(SELECT COUNT(DISTINCT EVENT_DATE) FT_COUNT FROM MON.SPARK_FT_SUBSCRIPTION_MSISDN_DAY WHERE EVENT_DATE BETWEEN TO_DATE ('###SLICE_VALUE###' || '-01') AND DATE_SUB(ADD_MONTHS (TO_DATE ('###SLICE_VALUE###' || '-01'), 1), 1)) B,
(SELECT COUNT(*) FT_COUNT FROM MON.SPARK_FT_CONTRACT_SNAPSHOT WHERE EVENT_DATE=ADD_MONTHS (TO_DATE ('###SLICE_VALUE###' || '-01'), 1)) C
