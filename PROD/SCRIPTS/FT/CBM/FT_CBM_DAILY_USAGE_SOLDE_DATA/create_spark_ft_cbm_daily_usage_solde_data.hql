desc MON.SPARK_FT_CBM_DAILY_USAGE_SOLDE_DATA;
show partitions MON.SPARK_FT_CBM_DAILY_USAGE_SOLDE_DATA;
show partitions  MON.SPARK_FT_CRA_GPRS_WITH_BAL_ID;
select event_date, count(*) from MON.SPARK_FT_CBM_DAILY_USAGE_SOLDE_DATA group by 1;
CREATE TABLE MON.SPARK_FT_CBM_DAILY_USAGE_SOLDE_DATA(
MSISDN VARCHAR(20),
ACCT_ID VARCHAR(20),
ACCT_RES_ID VARCHAR(20),
BAL_ID VARCHAR(20), 
-- BAL_EXTRACT
ACCT_RES_NAME VARCHAR(50),
ACCT_RES_RATING_SERVICE_CODE VARCHAR(50),
REMAIN_BAL_START DECIMAL(19, 5),
REMAIN_BAL_END DECIMAL(19, 5),
BAL_EFF_DATE TIMESTAMP,
BAL_EXP_DATE TIMESTAMP, 
-- DEPOT RECURRENT
DR_PROFILE VARCHAR(30),
DR_DEPOT DECIMAL(19,5),
DR_BEN_ACCT_ADD_RESULT DECIMAL(19, 5),
DR_BEN_ACCT_ADD_VAL DECIMAL(19, 5),
DR_USAGE VARCHAR(30),
DR_UNITE VARCHAR(10),
DR_BEN_ACCT_ADD_ACT_DATE TIMESTAMP,
DR_BEN_ACCT_ADD_EXP_DATE TIMESTAMP, 
-- SUBSCRIPTION
SUBSCRIP_RATED_AMOUNT DECIMAL(19, 5),
SUBSCRIP_NBR_SUSCRIPTION INT,
SUBSCRIP_BEN_ACCT_ADD_VAL DECIMAL(19, 5),
SUBSCRIP_BEN_ACCT_ADD_ACT_DATE TIMESTAMP,
SUBSCRIP_BEN_ACCT_ADD_EXP_DATE TIMESTAMP,
-- CRA GPRS FT_DATA
CRA_USED_BALANCE VARCHAR(200),
CRA_MO_SENT DECIMAL(19, 5),
CRA_MO_RECEIVED DECIMAL(19, 5),
CRA_MO_CHARGE_SUM DECIMAL(19, 5),
CRA_MO_USED_VOLUME DECIMAL(19, 5),
-- INSERTED_DATE
INSERTED_DATE TIMESTAMP
)COMMENT 'MON_SPARK_FT_CBM_DAILY_USAGE_SOLDE_DATA'
PARTITIONED BY (EVENT_DATE DATE)
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')