SELECT IF(
    T_1.FT_EXIST = 0
    AND T_2.COUNT_EVENT_DATE = ABS(datediff('###SLICE_VALUE###-01', DATE_SUB(ADD_MONTHS('###SLICE_VALUE###-01', 1), 1)) - 1)
    , 'OK'
    , 'NOK'
)
FROM
(SELECT COUNT(*) FT_EXIST FROM MON.SPARK_FT_DATAMART_USAGE_TRAFFIC_REVENU_MONTH WHERE EVENT_MONTH='###SLICE_VALUE###') T_1,
(
    SELECT 
    COUNT(DISTINCT EVENT_DATE) COUNT_EVENT_DATE 
    FROM MON.SPARK_FT_DATAMART_USAGE_TRAFFIC_REVENU_HOUR 
    WHERE EVENT_DATE BETWEEN '###SLICE_VALUE###-01' AND DATE_SUB(ADD_MONTHS('###SLICE_VALUE###-01', 1), 1) 
) T_2


