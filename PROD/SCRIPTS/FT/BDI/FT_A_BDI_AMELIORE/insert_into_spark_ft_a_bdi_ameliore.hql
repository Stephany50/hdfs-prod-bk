insert into MON.SPARK_FT_A_BDI_AMELIORE
select
'MAJEUR' AS TYPE_PERSONNE,
NB_NUMERO_PIECE_ABSENT AS NUM_PCE_ABSENT_NB,
NB_NUMERO_PIECE_INF_4 AS NUM_PCE_INF4_NB,
NB_NUMERO_PIECE_NON_AUTHORISE AS NUM_PCE_NO_AUT_NB,
NB_SCAN_INDISPONIBLE AS SCAN_PCE_ABSENT_NB,
0 AS NUM_PCE_TUT_ABSENT_NB,
0 AS NUM_PCE_TUT_NO_AUT_NB,
0 AS NUM_PCE_TUT_EG_M_NB,
NB_NOM_PRENOM_ABSENT AS NOM_PRENOM_ABSENT_NB,
NB_NOM_PRENOM_DOUTEUX AS NOM_PRENOM_DOUTEUX_NB,
NB_DATE_EXPIRATION_ABSENT AS DATE_EXPIR_ABSENT_NB,
NB_DATE_EXPIRATION_DOUTEUSE AS DATE_EXPIR_DOUTEUX_NB,
NB_DATE_NAISSANCE_ABSENT AS DATE_NAISS_ABSENT_NB,
NB_DATE_NAISSANCE_DOUTEUSE AS DATE_NAISS_DOUTEUX_NB,
NB_MULTI_SIM AS MULTISIM_NB,
NB_IMEI_ABSENT AS IMEI_ABSENT_NB,
0 AS NOM_TUT_ABSENT_NB,
0 AS NOM_TUT_DOUTEUX_NB,
0 AS DATE_NAISS_TUT_ABSENT_NB,
0 AS DATE_NAISS_TUT_DOUTEUX_NB,
NB_DATE_ACTIVATION_ABSENTE AS DATE_ACTIV_ABSENT_NB,
NB_MSISDN_ABSENT AS NUM_TEL_ABSENT_NB,
NB_TYPE_PIECE_IDENTITE AS TYPE_PCE_ID_ABSENT_NB,
ADRESSE_ABSENT AS ADRESSE_ABSENT_NB,
NB_ADDRESSE_DOUTEUSE AS ADRESSE_DOUTEUX_NB,
NB_CNI_EXPIRE AS CNI_EXPIR_NB,
NB_CONTRAT_SOUCRIPTION_ABSENT AS CONTRAT_SOUSCRI_ABSENT_NB,
SCAN_FANTAISISTE AS SCAN_FANTESISTE_NB,
NB_NUM_PIECE_UNIQUEMENT_LETR AS NUMERO_PIECE_UNIQ_EN_LETTRE_NB,
NB_NUM_PIECE_A_CARACT_NON_AUTH AS NUM_PIECE_A_CARACT_NON_AUT_NB,
NB_NUMERO_PIECE_EGALE_MSISDN AS NUMERO_PIECE_EGALE_MSISDN_NB,
NB_DATE_SOUSCRIPTION_ABSENTE AS DATE_SOUSCRIPTION_ABSENT_NB,
NB_PLAN_LOCALISATION_ABSENT AS PLAN_LOCAL_ABSENT_NB,
NB_LIGNES_EN_ANOMALIE AS LIGNE_EN_ANOMALIE_NB,
NB_ACTIFS AS ACTIF_FAMILLE_NB,
NB_FAMILLE AS TOTAL_FAMILLE_NB,
current_timestamp() AS insert_date,
date_add(to_date('###SLICE_VALUE###'), 1) AS EVENT_DATE_PLUS1
from TMP.TT_MAJ_AMELIORE
UNION ALL
select
'MINEUR' AS TYPE_PERSONNE,
NB_NUMERO_PIECE_ABSENT AS NUM_PCE_ABSENT_NB,
NB_NUMERO_PIECE_INF_4 AS NUM_PCE_INF4_NB,
NB_NUMERO_PIECE_NON_AUTHORISE AS NUM_PCE_NO_AUT_NB,
NB_SCAN_INDISPONIBLE AS SCAN_PCE_ABSENT_NB,
NB_NUMERO_PIECE_TUT_ABSENT AS NUM_PCE_TUT_ABSENT_NB,
NB_NUMERO_PIECE_TUT_NON_AUTH AS NUM_PCE_TUT_NO_AUT_NB,
NB_NUM_PIECE_TUT_EGALE_MSISDN AS NUM_PCE_TUT_EG_M_NB,
NB_NOM_PRENOM_ABSENT AS NOM_PRENOM_ABSENT_NB,
NOM_PRENOM_DOUTEUX AS NOM_PRENOM_DOUTEUX_NB,
NB_DATE_EXPIRATION_ABSENT AS DATE_EXPIR_ABSENT_NB,
NB_DATE_NAISSANCE_DOUTEUX AS DATE_EXPIR_DOUTEUX_NB,
NB_DATE_NAISSANCE_ABSENT AS DATE_NAISS_ABSENT_NB,
NB_DATE_NAISSANCE_DOUTEUX AS DATE_NAISS_DOUTEUX_NB,
NB_MULTI_SIM AS MULTISIM_NB,
NB_IMEI_ABSENT AS IMEI_ABSENT_NB,
NB_NOM_PARENT_ABSENT AS NOM_TUT_ABSENT_NB,
NB_NOM_PARENT_DOUTEUX AS NOM_TUT_DOUTEUX_NB,
NB_DATE_NAISSANCE_TUT_ABSENT AS DATE_NAISS_TUT_ABSENT_NB,
NB_DATE_NAISSANCE_TUT_DOUTEUX AS DATE_NAISS_TUT_DOUTEUX_NB,
NB_DATE_ACTIVATION_ABSENTE AS DATE_ACTIV_ABSENT_NB,
NB_MSISDN_ABSENT AS NUM_TEL_ABSENT_NB,
NB_TYPE_PIECE_IDENTITE_ABSENTE AS TYPE_PCE_ID_ABSENT_NB,
NB_ADRESSE_ABSENT AS ADRESSE_ABSENT_NB,
NB_ADDRESSE_DOUTEUSE AS ADRESSE_DOUTEUX_NB,
NB_CNI_EXPIRE AS CNI_EXPIR_NB,
NB_CONTRAT_SOUCRIPTION_ABSENT AS CONTRAT_SOUSCRI_ABSENT_NB,
SCAN_FANTAISISTE AS SCAN_FANTESISTE_NB,
0 AS  NUMERO_PIECE_UNIQ_EN_LETTRE_NB,
0 AS NUM_PIECE_A_CARACT_NON_AUT_NB,
0 AS NUMERO_PIECE_EGALE_MSISDN_NB,
0 AS DATE_SOUSCRIPTION_ABSENT_NB,
NB_PLAN_LOCALISATION_ABSENT AS PLAN_LOCAL_ABSENT_NB,
NB_LIGNE_EN_ANOMALIE AS LIGNE_EN_ANOMALIE_NB,
NB_ACTIFS AS ACTIF_FAMILLE_NB,
NB_FAMILLE AS TOTAL_FAMILLE_NB,
current_timestamp() AS insert_date,
date_add(to_date('###SLICE_VALUE###'), 1) AS EVENT_DATE_PLUS1
from TMP.TT_MIN_AMELIORE