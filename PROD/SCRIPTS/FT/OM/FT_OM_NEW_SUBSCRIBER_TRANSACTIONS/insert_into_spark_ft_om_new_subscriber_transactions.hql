INSERT INTO MON.SPARK_FT_OM_NEW_SUBSCRIBER_TRANSACTIONS
SELECT
MSISDN,
USER_ID,
CREATION_DATE,
USER_TYPE,
MODIFIED_ON,
FIRST_TRANSACTION_ON,
TRANSFER_ID,
SERVICE_TYPE,
LAST_TRANSACTION,
TRANSFER_STATUS,
TRANSACTION_AMOUNT,
SERVICE_CHARGE_RECEIVED,
CURRENT_TIMESTAMP AS INSERT_DATE,
MODIFICATION_DATE AS EVENT_DATE
FROM
(
SELECT A1.MSISDN AS MSISDN, A1.USER_ID AS USER_ID, A1.CREATION_DATE AS CREATION_DATE,A1.USER_TYPE AS USER_TYPE,
      A1.MODIFIED_ON AS MODIFIED_ON,A1.FIRST_TRANSACTION_ON AS FIRST_TRANSACTION_ON, B1.TRANSFER_ID AS TRANSFER_ID, B1.SERVICE_TYPE AS SERVICE_TYPE,B1.MODIFIED_ON AS LAST_TRANSACTION,
      B1.TRANSFER_STATUS AS TRANSFER_STATUS, B1.TRANSACTION_AMOUNT AS TRANSACTION_AMOUNT,
      B1.SERVICE_CHARGE_RECEIVED AS SERVICE_CHARGE_RECEIVED,A1.MODIFICATION_DATE AS MODIFICATION_DATE
      FROM
           ( SELECT *  FROM CDR.SPARK_IT_OM_SUBSCRIBERS WHERE CREATION_DATE ='###SLICE_VALUE###' ) A1
      INNER JOIN (SELECT * FROM CDR.SPARK_IT_OMNY_TRANSACTIONS WHERE TRANSFER_DATETIME='###SLICE_VALUE###')B1  ON A1.MSISDN = B1.SENDER_MSISDN
      UNION
      SELECT A2.MSISDN AS MSISDN, A2.USER_ID AS USER_ID, A2.CREATION_DATE AS CREATION_DATE,A2.USER_TYPE AS USER_TYPE,
      A2.MODIFIED_ON AS MODIFIED_ON,A2.FIRST_TRANSACTION_ON AS FIRST_TRANSACTION_ON, B2.TRANSFER_ID AS TRANSFER_ID, B2.SERVICE_TYPE AS SERVICE_TYPE,B2.MODIFIED_ON AS LAST_TRANSACTION,
      B2.TRANSFER_STATUS AS TRANSFER_STATUS, B2.TRANSACTION_AMOUNT AS TRANSACTION_AMOUNT,
      B2.SERVICE_CHARGE_RECEIVED AS SERVICE_CHARGE_RECEIVED,A2.MODIFICATION_DATE AS MODIFICATION_DATE
      FROM
            ( SELECT *  FROM CDR.SPARK_IT_OM_SUBSCRIBERS WHERE CREATION_DATE ='###SLICE_VALUE###' ) A2
      INNER JOIN (SELECT * FROM CDR.SPARK_IT_OMNY_TRANSACTIONS WHERE TRANSFER_DATETIME='###SLICE_VALUE###')B2 ON A2.MSISDN = B2.RECEIVER_MSISDN
      ) T