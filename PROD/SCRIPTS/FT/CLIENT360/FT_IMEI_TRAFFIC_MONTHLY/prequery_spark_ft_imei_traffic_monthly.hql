SELECT IF(FT_EXISTS=0 AND CONTRACT_SNAPSHOT_EXISTS>0 and SDATE_COUNT=1+datediff(DATE_SUB(ADD_MONTHS ('###SLICE_VALUE###' ||  '-01' , 1) , 1),'###SLICE_VALUE###' ||  '-01'),'OK','NOK') RESULT
FROM
(SELECT COUNT(*) FT_EXISTS FROM MON.SPARK_FT_IMEI_TRAFFIC_MONTHLY WHERE SMONTH=date_format('###SLICE_VALUE###' ||  '-01','yyyyMM') )A,
(SELECT COUNT(DISTINCT SDATE) SDATE_COUNT FROM MON.SPARK_FT_IMEI_ONLINE WHERE  sdate BETWEEN   '###SLICE_VALUE###' ||  '-01' AND DATE_SUB(ADD_MONTHS ('###SLICE_VALUE###' ||  '-01' , 1) , 1))B,
(SELECT COUNT(*) CONTRACT_SNAPSHOT_EXISTS FROM MON.SPARK_FT_CONTRACT_SNAPSHOT WHERE EVENT_DATE=ADD_MONTHS ('###SLICE_VALUE###' ||  '-01' , 1))C