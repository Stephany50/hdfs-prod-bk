SELECT IF( FORFAIT>0 and SUBS>10000 and SOUSCRIPTION>1000 and PARRAIN>=0 and FT=0, 'OK', 'NOK' ) TABLES_STATES
FROM
( SELECT COUNT(*) FT FROM MON.SPARK_FT_PULSE_SPIDER_POINT WHERE EVENT_DATE = '###SLICE_VALUE###' ) F,
( SELECT COUNT(*) FORFAIT FROM CDR.SPARK_IT_PULSE_SPIDER_FORFAIT WHERE ORIGINAL_FILE_DATE <= '###SLICE_VALUE###' ) A,
( SELECT COUNT(*) PARRAIN FROM CDR.SPARK_IT_PULSE_SPIDER_PARRAIN WHERE ORIGINAL_FILE_DATE = '###SLICE_VALUE###' ) B,
( SELECT COUNT(*) SOUSCRIPTION FROM MON.SPARK_FT_SUBSCRIPTION WHERE TRANSACTION_DATE = '###SLICE_VALUE###' ) C,
( SELECT COUNT(*) SUBS FROM CDR.SPARK_IT_ZTE_SUBS_EXTRACT WHERE ORIGINAL_FILE_DATE= DATE_ADD('###SLICE_VALUE###',0) ) D