CREATE TABLE CDR.SPARK_IT_BILL_PER_SUBSCRIBER
(
    ACCT_NBR VARCHAR(200),
    ACCT_NAME VARCHAR(200),
    ACC_NBR VARCHAR(200),
    SUBS_PLAN VARCHAR(200),
    BILL_NBR VARCHAR(200),
    SUBS_CHARGE VARCHAR(200),
    VARIATION VARCHAR(200),
    ORIGINAL_FILE_NAME VARCHAR(200),
    INSERT_DATE TIMESTAMP,
    ORIGINAL_FILE_DATE  DATE

)
PARTITIONED BY (event_date DATE)
STORED AS PARQUET
TBLPROPERTIES ("parquet.compress"="SNAPPY");



CREATE EXTERNAL TABLE CDR.SPARK_TT_BILL_PER_SUBSCRIBER
(
    ORIGINAL_FILE_NAME VARCHAR(200),
    ORIGINAL_FILE_SIZE INT,
    ORIGINAL_FILE_LINE_COUNT INT,
    ACCT_NBR VARCHAR(200),
    ACCT_NAME VARCHAR(200),
    ACC_NBR VARCHAR(200),
    SUBS_PLAN VARCHAR(200),
    BILL_NBR VARCHAR(200),
    SUBS_CHARGE VARCHAR(200),
    VARIATION VARCHAR(200)

)COMMENT 'CDR SPARK_TT_BILL_PER_SUBSCRIBER'
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
   "separatorChar" = "\;"
)
LOCATION '/PROD/TT/STAT_TOOLS/DATAMARTB2B/BILL_PER_SUBSCRIBER'
TBLPROPERTIES ('serialization.null.format'='');
