
INSERT INTO MON.SPARK_FT_SUBSCRIPTION_B2B PARTITION(TRANSACTION_DATE)
SELECT 
TRANSACTION_TIME,
SERVED_PARTY_MSISDN ,
CONTRACT_TYPE ,
COMMERCIAL_OFFER,
OPERATOR_CODE,
SUBSCRIPTION_CHANNEL,
SERVICE_LIST,
SUBSCRIPTION_SERVICE,
SUBSCRIPTION_SERVICE_DETAILS,
SUBSCRIPTION_RELATED_SERVICE,
RATED_AMOUNT ,
MAIN_BALANCE_USED,
ACTIVE_DATE ,
ACTIVE_TIME, 
EXPIRE_DATE ,
EXPIRE_TIME,
SUBSCRIPTION_STATUS,
PREVIOUS_COMMERCIAL_OFFER,
PREVIOUS_STATUS,
PREVIOUS_SUBS_SERVICE_DETAILS,
PREVIOUS_SUBS_RELATED_SERVICE,
TERMINATION_INDICATOR,
BENEFIT_BALANCE_LIST,
BENEFIT_UNIT_LIST,
BENEFIT_ADDED_VALUE_LIST,
BENEFIT_RESULT_VALUE_LIST,
BENEFIT_ACTIVE_DATE_LIST,
BENEFIT_EXPIRE_DATE_LIST,
TOTAL_OCCURENCE,
INSERT_DATE,
SOURCE_INSERT_DATE ,
ORIGINAL_FILE_NAME,
SERVICE_CODE,
AMOUNT_VOICE_ONNET ,
AMOUNT_VOICE_OFFNET ,
AMOUNT_VOICE_INTER ,
AMOUNT_VOICE_ROAMING ,
AMOUNT_SMS_ONNET ,
AMOUNT_SMS_OFFNET ,
AMOUNT_SMS_INTER ,
AMOUNT_SMS_ROAMING ,
AMOUNT_DATA ,
AMOUNT_SVA ,
COMBO ,
benefit_bal_list,
TRANSACTION_DATE
FROM MON.SPARK_FT_SUBSCRIPTION
WHERE transaction_date = '2023-03-10' AND 
upper(trim(commercial_offer)) in 
(upper(trim("PrePaid Classique")),
upper(trim("Flex")),
upper(trim("Flex Modulo")),
upper(trim("Schlumberger")),
upper(trim("Communaute")),
upper(trim("Prepaid Honorable")),
upper(trim("Flex Plus")),
upper(trim("SIM OPEL Main Product")),
upper(trim("All In One")),
upper(trim("Orange Pro Bundle")),
upper(trim("Access Communaute Plus")),
upper(trim("FORFAISELE")),
upper(trim("Orange Pro")),
upper(trim("ForfaitData")),
upper(trim("Flybox Pro")),
upper(trim("Prepaid DataLive")),
upper(trim("Mobility")),
upper(trim("PrePaid Perso")),
upper(trim("PrePaid Pro")),
upper(trim("Access Communaute SOHO")),
upper(trim("MIX")),
upper(trim("Cloud Pro"))
)