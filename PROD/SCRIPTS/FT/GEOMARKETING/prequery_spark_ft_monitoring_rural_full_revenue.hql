SELECT IF(T_1.FT_MONITORING_RURAL_FULL_REVENUE_COUNT = 0 and
 T_2.FT_GEOMARKETING_REPORT_360_COUNT > 0 and
    T_3.FT_BILLED_TRANSACTION_PREPAID_COUNT > 0 and
    T_4.FT_CRA_GPRS_COUNT > 0 and
    T_5.FT_SUBSCRIPTION_COUNT > 0 and
    T_6.FT_SUBS_RETAIL_ZEBRA_COUNT > 0 and
    T_7.FT_CONTRACT_SNAPSHOT_COUNT > 0 and
    T_8.FT_CREDIT_TRANSFER_COUNT > 0 and
    T_9.FT_DATA_TRANSFER_COUNT > 0 and
    T_10.FT_CLIENT_LAST_SITE_DAY_COUNT > 0 and
    T_11.FT_CLIENT_SITE_TRAFFIC_DAY_COUNT > 0 and
    T_12.FT_SITE_360_COUNT > 0 and
    T_13.FT_GEOMARKETING_REPORT_360_MTD_COUNT > 0 and
    T_14.FT_ACCOUNT_ACTIVITY_COUNT > 0 and
    T_15.IT_OMNY_TRANSACTIONS_COUNT > 0,"OK","NOK") COUNT_DAY_EXIST
FROM
    (SELECT COUNT(*) FT_MONITORING_RURAL_FULL_REVENUE_COUNT FROM MON.SPARK_FT_MONITORING_RURAL_FULL_REVENUE WHERE event_date='###SLICE_VALUE###') T_1,
    (SELECT COUNT(*) FT_GEOMARKETING_REPORT_360_COUNT FROM MON.SPARK_FT_GEOMARKETING_REPORT_360 WHERE event_date='###SLICE_VALUE###') T_2,
    (SELECT COUNT(*) FT_BILLED_TRANSACTION_PREPAID_COUNT FROM MON.SPARK_FT_BILLED_TRANSACTION_PREPAID WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_3,
    (SELECT COUNT(*) FT_CRA_GPRS_COUNT FROM MON.SPARK_FT_CRA_GPRS WHERE SESSION_DATE='###SLICE_VALUE###') T_4,
    (SELECT COUNT(*) FT_SUBSCRIPTION_COUNT FROM MON.SPARK_FT_SUBSCRIPTION WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_5,
    (SELECT COUNT(*) FT_SUBS_RETAIL_ZEBRA_COUNT FROM MON.SPARK_FT_SUBS_RETAIL_ZEBRA WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_6,
    (SELECT COUNT(*) FT_CONTRACT_SNAPSHOT_COUNT FROM MON.SPARK_FT_CONTRACT_SNAPSHOT WHERE EVENT_DATE=DATE_ADD('###SLICE_VALUE###',1)) T_7,
    (SELECT COUNT(*) FT_CREDIT_TRANSFER_COUNT FROM MON.SPARK_FT_CREDIT_TRANSFER WHERE REFILL_DATE='###SLICE_VALUE###') T_8,
    (SELECT COUNT(*) FT_DATA_TRANSFER_COUNT FROM MON.SPARK_FT_DATA_TRANSFER WHERE TRANSACTION_DATE='###SLICE_VALUE###') T_9,
    (SELECT COUNT(*) FT_CLIENT_LAST_SITE_DAY_COUNT FROM MON.SPARK_FT_CLIENT_LAST_SITE_DAY WHERE EVENT_DATE='###SLICE_VALUE###') T_10,
    (SELECT COUNT(*) FT_CLIENT_SITE_TRAFFIC_DAY_COUNT FROM MON.SPARK_FT_CLIENT_SITE_TRAFFIC_DAY WHERE EVENT_DATE='###SLICE_VALUE###') T_11,
    (SELECT COUNT(*) FT_SITE_360_COUNT FROM MON.SPARK_FT_SITE_360 WHERE EVENT_DATE='###SLICE_VALUE###') T_12,
    (SELECT COUNT(*) FT_GEOMARKETING_REPORT_360_MTD_COUNT FROM MON.SPARK_FT_GEOMARKETING_REPORT_360_MTD WHERE EVENT_DATE='###SLICE_VALUE###') T_13,
    (SELECT COUNT(*) FT_ACCOUNT_ACTIVITY_COUNT FROM MON.SPARK_FT_ACCOUNT_ACTIVITY WHERE EVENT_DATE=DATE_ADD('###SLICE_VALUE###',1)) T_14,
    (SELECT COUNT(*) IT_OMNY_TRANSACTIONS_COUNT FROM CDR.SPARK_IT_OMNY_TRANSACTIONS WHERE TRANSFER_DATETIME='###SLICE_VALUE###') T_15