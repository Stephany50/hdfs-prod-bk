create table dim.spark_dt_regions_mkt_v2 as
select region_id,upper(a.administrative_region) administrative_region , upper(nvl(b.commercial_region,'INCONNU')) commercial_region from dim.dt_regions_mkt a left join  (select distinct upper(region) administrative_region,upper(commercial_region) commercial_region from (select administrative_region region , ci from VW_SDT_CI_INFO_NEW ) t where region is not null and commercial_region is not null)b on upper(a.administrative_region) = upper(b.administrative_region);
