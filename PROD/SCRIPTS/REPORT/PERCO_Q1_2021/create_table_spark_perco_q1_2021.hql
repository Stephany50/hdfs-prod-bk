create TABLE mon.spark_ft_perco_q1_2021
(
    site_name varchar(200),
    users_backend_daily bigint,
    users_backend_mtd bigint,
    takers_best_deal_offer_daily bigint,
    takers_best_deal_offer_mtd bigint,
    takers_best_deal_voice_offer_daily bigint,
    takers_best_deal_voice_offer_mtd bigint,
    takers_best_deal_data_offer_daily bigint,
    takers_best_deal_data_offer_mtd bigint,
    takers_best_deal_combo_offer_daily bigint,
    takers_best_deal_combo_offer_mtd bigint,
    takers_myway_plus_daily bigint,
    takers_myway_plus_mtd bigint,
    takers_myway_plus_voice_offer_daily bigint,
    takers_myway_plus_voice_offer_mtd bigint,
    takers_myway_plus_data_offer_daily bigint,
    takers_myway_plus_data_offer_mtd bigint,
    takers_myway_plus_combo_offer_daily bigint,
    takers_myway_plus_combo_offer_mtd bigint,
    takers_myway_plus_via_om_daily bigint,
    takers_myway_plus_via_om_mtd bigint,
    subscriptions_best_deal_offer_daily bigint,
    subscriptions_best_deal_voice_offer_daily bigint,
    subscriptions_best_deal_data_offer_daily bigint,
    subscriptions_best_deal_combo_offer_daily bigint,
    subscriptions_myway_plus_daily bigint,
    subscriptions_myway_plus_voice_offer_daily bigint,
    subscriptions_myway_plus_data_offer_daily bigint,
    subscriptions_myway_plus_combo_offer_daily bigint,
    subscriptions_myway_plus_via_om_daily bigint,
    revenu_best_deal_offer_daily decimal(20,3),
    revenu_best_deal_voice_offer_daily decimal(20,3),
    revenu_best_deal_data_offer_daily decimal(20,3),
    revenu_myway_plus_daily decimal(20,3),
    revenu_myway_plus_voice_offer_daily decimal(20,3),
    revenu_myway_plus_data_offer_daily decimal(20,3),
    revenu_myway_plus_via_om_daily decimal(20,3),
    usage_takers_voice_offer_daily decimal(20,3),
    usage_takers_data_offer_daily decimal(20,3),
    takers_incremental_best_deal_offer_daily bigint,
    takers_incremental_best_deal_voice_offer_daily bigint,
    takers_incremental_best_deal_data_offer_daily bigint,
    takers_incremental_best_deal_combo_offer_daily bigint,
    takers_incremental_myway_plus_daily bigint,
    takers_incremental_myway_plus_voice_offer_daily bigint,
    takers_incremental_myway_plus_data_offer_daily bigint,
    takers_incremental_myway_plus_combo_offer_daily bigint,
    takers_incremental_myway_plus_via_om_daily bigint,
    takers_incremental_best_deal_offer_mtd bigint,
    takers_incremental_best_deal_voice_offer_mtd bigint,
    takers_incremental_best_deal_data_offer_mtd bigint,
    takers_incremental_best_deal_combo_offer_mtd bigint,
    takers_incremental_myway_plus_mtd bigint,
    takers_incremental_myway_plus_voice_offer_mtd bigint,
    takers_incremental_myway_plus_data_offer_mtd bigint,
    takers_incremental_myway_plus_combo_offer_mtd bigint,
    takers_incremental_myway_plus_via_om_mtd bigint,
    subscriptions_incremental_best_deal_offer_daily bigint,
    subscriptions_incremental_best_deal_voice_offer_daily bigint,
    subscriptions_incremental_best_deal_data_offer_daily bigint,
    subscriptions_incremental_best_deal_combo_offer_daily bigint,
    subscriptions_incremental_myway_plus_daily bigint,
    subscriptions_incremental_myway_plus_voice_offer_daily bigint,
    subscriptions_incremental_myway_plus_data_offer_daily bigint,
    subscriptions_incremental_myway_plus_combo_offer_daily bigint,
    subscriptions_incremental_myway_plus_via_om_daily bigint,
    ca_voix_incremental_daily decimal(20,3),
    ca_data_incremental_daily decimal(20,3),
    ca_paygo_incremental_daily decimal(20,3),
    ca_global_incremental_daily decimal(20,3),
    usage_incremental_takers_voice_offer_daily decimal(20,3),
    usage_incremental_takers_data_offer_daily decimal(20,3),
    insert_date timestamp
)
COMMENT 'Table for PERCO Q1 2021'
PARTITIONED BY (event_date DATE)
STORED AS PARQUET TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY')
