SELECT IF(A.FT_EXIST = 0 and B.FT_COUNT>DATEDIFF(LAST_DAY(CONCAT('###SLICE_VALUE###','-01')), CONCAT('###SLICE_VALUE###','-01')), "OK","NOK") FROM
(SELECT COUNT(*) FT_EXIST FROM MON.SPARK_FT_ROAMING_RETAIL_OUT_MONTH WHERE EVENT_MONTH='###SLICE_VALUE###') A,
(SELECT COUNT(*) FT_COUNT FROM MON.SPARK_FT_ROAMING_RETAIL_OUT WHERE EVENT_DATE BETWEEN TO_DATE(CONCAT('###SLICE_VALUE###','-01')) AND LAST_DAY(CONCAT('###SLICE_VALUE###','-01'))) B
