SELECT IF(COUNTER=0 OR T2.STATUS='NOK','OK','NOK')   FROM (SELECT COUNT(*) COUNTER,1 join_colum FROM MON.SPARK_MISSING_FILES_STATUS a WHERE ORIGINAL_FILE_DATE ='###SLICE_VALUE###' AND JOB_SOURCE='${hivevar:job_source}' )T1
LEFT JOIN (SELECT STATUS ,1 join_colum FROM  MON.SPARK_MISSING_FILES_STATUS WHERE ORIGINAL_FILE_DATE ='###SLICE_VALUE###' AND JOB_SOURCE='${hivevar:job_source}' )T2 on T1.join_colum=T2.join_colum